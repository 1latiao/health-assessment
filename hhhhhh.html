<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥åº·æ£€æµ‹ä¸­å¿ƒ</title>
    <style>
        /* å…¨å±€æ ·å¼ */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #f0f8ff 0%, #e6f7ff 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        /* ç¡çœ æµ‹è¯„ç‰¹å®šæ ·å¼ */
.question-group {
    margin-bottom: 1.5rem;
    padding: 1rem;
    background-color: #f8f9fa;
    border-radius: 8px;
    border-left: 3px solid #4CAF50;
}

.question-group h3 {
    color: #2E7D32;
    margin-bottom: 0.8rem;
    font-size: 1.1rem;
}

/* æ—¶é—´è¾“å…¥æ¡†æ ·å¼ */
input[type="time"] {
    padding: 0.8rem;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 16px;
}
/* è¿åŠ¨è¯„ä¼°ç‰¹å®šæ ·å¼ */
.input-with-unit {
    display: flex;
    align-items: center;
}

.input-with-unit input {
    width: 80%;
    margin-right: 10px;
}

.input-with-unit span {
    white-space: nowrap;
    color: #666;
}

/* è¿åŠ¨å»ºè®®å¡ç‰‡ */
.fitness-card {
    background: white;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 15px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    border-left: 4px solid #4CAF50;
}

.fitness-card h4 {
    color: #2E7D32;
    margin-top: 0;
    margin-bottom: 10px;
}

/* è¿åŠ¨å¼ºåº¦æŒ‡ç¤ºå™¨ */
.intensity-meter {
    height: 10px;
    background: #e0e0e0;
    border-radius: 5px;
    margin: 10px 0;
    overflow: hidden;
}

.intensity-meter-fill {
    height: 100%;
    background: linear-gradient(to right, #4CAF50, #FFC107, #F44336);
    border-radius: 5px;
}
/* å¿ƒç†å¥åº·è¯„ä¼°ç‰¹å®šæ ·å¼ */
.warning-box {
    border-left: 4px solid #f44336;
    background-color: #ffebee;
}

.mental-health-scale {
    margin: 15px 0;
    padding: 10px;
    border-radius: 8px;
    background: #f5f5f5;
}

.scale-meter {
    height: 10px;
    background: #e0e0e0;
    border-radius: 5px;
    margin: 10px 0;
    overflow: hidden;
}

.scale-meter-fill {
    height: 100%;
    border-radius: 5px;
}

.depression-fill {
    background: #2196F3; /* è“è‰² */
}

.anxiety-fill {
    background: #FF9800; /* æ©™è‰² */
}

.stress-fill {
    background: #4CAF50; /* ç»¿è‰² */
}

.coping-card {
    background: white;
    border-radius: 8px;
    padding: 15px;
    margin: 15px 0;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.coping-card h4 {
    color: #333;
    margin-top: 0;
    border-bottom: 1px solid #eee;
    padding-bottom: 8px;
}
/* é¥®é£Ÿè¯„ä¼°ç‰¹å®šæ ·å¼ */
.checkbox-group {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    margin-top: 10px;
}

.checkbox-group label {
    display: flex;
    align-items: center;
    font-weight: normal;
}

.checkbox-group input {
    margin-right: 8px;
    width: auto;
}

.nutrition-card {
    background: white;
    border-radius: 8px;
    padding: 15px;
    margin: 15px 0;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.nutrition-card h4 {
    color: #2E7D32;
    margin-top: 0;
    border-bottom: 1px solid #eee;
    padding-bottom: 8px;
}

.nutrition-score {
    font-size: 1.5rem;
    font-weight: bold;
    color: #4CAF50;
    margin: 10px 0;
}

.nutrition-meter {
    height: 10px;
    background: #e0e0e0;
    border-radius: 5px;
    margin: 10px 0;
    overflow: hidden;
}

.nutrition-meter-fill {
    height: 100%;
    background: linear-gradient(to right, #F44336, #FFC107, #4CAF50);
    border-radius: 5px;
}

.food-group {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin: 10px 0;
}

.food-item {
    background: #E8F5E9;
    padding: 8px 12px;
    border-radius: 20px;
    font-size: 0.9rem;
}

.food-item.recommended {
    background: #C8E6C9;
    font-weight: bold;
}

.food-item.limited {
    background: #FFEBEE;
}


/* å†å²è®°å½•é¡µé¢æ ·å¼ */
.report-item {
  background: white;
  border-radius: 10px;
  padding: 20px;
  margin-bottom: 15px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.08);
  border-left: 4px solid #4CAF50;
  transition: transform 0.3s ease;
}

.report-item:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.report-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.report-title {
  color: #2E7D32;
  font-size: 1.2rem;
  font-weight: 600;
}

.report-score {
  font-size: 1.5rem;
  font-weight: bold;
  color: #4CAF50;
}

.report-details {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 10px;
  margin-top: 10px;
}

.detail-item {
  background: #f8f9fa;
  padding: 10px;
  border-radius: 6px;
}

.detail-label {
  font-size: 0.9rem;
  color: #666;
}

.detail-value {
  font-weight: 500;
}

/* å¯¼å‡ºæŒ‰é’®ç¾åŒ– */
.export-btn {
  background: linear-gradient(to right, #2196F3, #0D47A1);
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 30px;
  cursor: pointer;
  font-size: 1rem;
  font-weight: 600;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  transition: all 0.3s ease;
  box-shadow: 0 4px 10px rgba(33, 150, 243, 0.3);
}

.export-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 15px rgba(33, 150, 243, 0.4);
}

/* ç©ºçŠ¶æ€æç¤º */
.empty-state {
  text-align: center;
  padding: 40px 0;
  color: #666;
}

.empty-state i {
  font-size: 3rem;
  color: #e0e0e0;
  margin-bottom: 15px;
}





        /* å¯¼èˆªæ ·å¼ */
        nav {
            background: linear-gradient(to right, #4CAF50, #2E7D32);
            padding: 1.2rem;
            margin-bottom: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: center;
        }

        nav a {
            color: white;
            text-decoration: none;
            margin: 0 1.5rem;
            font-size: 1.1rem;
            padding: 8px 16px;
            border-radius: 30px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        nav a:hover, nav a.active {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* é¡µé¢å®¹å™¨ */
        .page {
            display: none;
            animation: fadeIn 0.5s ease forwards;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* å¡ç‰‡æ ·å¼ */
        .card {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
        }

        h1 {
            color: #2E7D32;
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 2.2rem;
            position: relative;
            padding-bottom: 15px;
        }

        h1:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(to right, #4CAF50, #81C784);
            border-radius: 2px;
        }

        h2 {
            color: #388E3C;
            margin-bottom: 1rem;
        }

        /* è¾“å…¥ç»„æ ·å¼ */
        .input-group {
            margin-bottom: 1.8rem;
        }

        label {
            display: block;
            margin-bottom: 0.6rem;
            font-weight: 500;
            color: #555;
        }

        input, select, textarea {
            width: 100%;
            padding: 0.9rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            border-color: #4CAF50;
            outline: none;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }

        button {
            background: linear-gradient(to right, #4CAF50, #2E7D32);
            color: white;
            border: none;
            padding: 1.1rem 2rem;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-size: 1.05rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3);
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(76, 175, 80, 0.4);
        }

        button:active {
            transform: translateY(1px);
        }

        /* ç»“æœæ ·å¼ */
        .result {
            margin-top: 1.8rem;
            padding: 1.5rem;
            border-radius: 10px;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .result h2 {
            margin-top: 0;
        }

        /* å‚è€ƒæ ‡å‡† */
        .reference, .bmi-scale {
            margin-top: 2rem;
            padding: 1.5rem;
            background: #e8f4ff;
            border-radius: 10px;
            border-left: 4px solid #2196F3;
        }

        /* å»ºè®®éƒ¨åˆ† */
        .advice-section {
            margin-top: 1.5rem;
        }

        .exercise-advice {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 1.2rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .diet-advice {
            background: #f0f4c3;
            border-left: 4px solid #CDDC39;
            padding: 1.2rem;
            border-radius: 8px;
        }

        .sleep-advice {
            background: #e1f5fe;
            border-left: 4px solid #03A9F4;
            padding: 1.2rem;
            border-radius: 8px;
        }

        .mental-advice {
            background: #f3e5f5;
            border-left: 4px solid #9C27B0;
            padding: 1.2rem;
            border-radius: 8px;
        }

        .warning {
            color: #d32f2f;
            font-weight: bold;
            margin: 1.2rem 0;
            padding: 1rem;
            background: #ffebee;
            border-radius: 8px;
            border-left: 4px solid #d32f2f;
        }

        ul {
            padding-left: 1.8rem;
            margin: 0.8rem 0;
        }

        li {
            margin-bottom: 0.5rem;
        }

        /* ä¸»é¡µæ ·å¼ */
        .hero {
            text-align: center;
            padding: 3rem 0;
            margin-bottom: 2rem;
        }

        .hero h1 {
            font-size: 2.8rem;
            margin-bottom: 1rem;
            color: #2E7D32;
        }

        .hero p {
            font-size: 1.2rem;
            color: #555;
            max-width: 700px;
            margin: 0 auto 2rem;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 2rem;
        }

        .feature-card {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            text-align: center;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.12);
        }

        .feature-icon {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            color: #4CAF50;
        }

        .feature-card h3 {
            color: #2E7D32;
            margin-bottom: 1rem;
        }

        /* è¿›åº¦æ¡ */
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin: 20px 0;
        }

        .progress-bar {
            height: 20px;
            border-radius: 5px;
            background-color: #4CAF50;
            width: 0%;
            transition: width 0.5s;
        }

        /* é—®é¢˜æ ·å¼ */
        .question {
            margin-bottom: 15px;
            padding: 10px;
            border-left: 3px solid #4CAF50;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            nav {
                flex-wrap: wrap;
            }

            nav a {
                margin: 5px;
                font-size: 1rem;
            }

            .hero h1 {
                font-size: 2.2rem;
            }

            .card {
                padding: 1.5rem;
            }
        }

        /* é¡µè„š */
        footer {
            text-align: center;
            padding: 2rem 0;
            margin-top: 3rem;
            color: #666;
            border-top: 1px solid #eee;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- å¯¼èˆªæ  -->
        <nav>
            <a href="#" class="nav-link active" data-page="home">é¦–é¡µ</a>
            <a href="#" class="nav-link" data-page="blood-sugar">è¡€ç³–æ£€æµ‹</a>
            <a href="#" class="nav-link" data-page="bmi">BMIè®¡ç®—</a>
            <a href="#" class="nav-link" data-page="sleep">ç¡çœ è´¨é‡</a>
            <a href="#" class="nav-link" data-page="exercise">è¿åŠ¨æ°´å¹³</a>
            <a href="#" class="nav-link" data-page="diet">é¥®é£Ÿå¥åº·</a>
            <a href="#" class="nav-link" data-page="mental">å¿ƒç†å¥åº·</a>
            <a href="#" class="nav-link" data-page="history">å†å²è®°å½•</a>
             <a href="#" class="nav-link" data-page="summary">ç»¼åˆè¯„çº§</a>
        </nav>

        <!-- é¦–é¡µå†…å®¹ -->
        <div id="home" class="page active">
            <div class="hero">
                <h1>å¥åº·æ£€æµ‹ä¸­å¿ƒ</h1>
                <p>ä¸“ä¸šçš„å¥åº·æ£€æµ‹å·¥å…·ï¼ŒåŠ©æ‚¨äº†è§£èº«ä½“çŠ¶å†µï¼Œè·å–ä¸ªæ€§åŒ–å¥åº·å»ºè®®</p>
            </div>

            <div class="features">
                <div class="feature-card">
                    <div class="feature-icon">ğŸ©¸</div>
                    <h3>è¡€ç³–æ£€æµ‹</h3>
                    <p>ç²¾å‡†æ£€æµ‹æ‚¨çš„è¡€ç³–æ°´å¹³ï¼Œæ ¹æ®ç»“æœæä¾›é¥®é£Ÿå’Œè¿åŠ¨å»ºè®®</p>
                    <button class="goto-btn" data-page="blood-sugar">å¼€å§‹æ£€æµ‹</button>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">âš–ï¸</div>
                    <h3>BMIè®¡ç®—</h3>
                    <p>è®¡ç®—èº«ä½“è´¨é‡æŒ‡æ•°ï¼Œè¯„ä¼°ä½“é‡çŠ¶å†µï¼Œè·å–ä¸ªæ€§åŒ–å¥åº·æ–¹æ¡ˆ</p>
                    <button class="goto-btn" data-page="bmi">å¼€å§‹è®¡ç®—</button>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">ğŸŒ™</div>
                    <h3>ç¡çœ è´¨é‡</h3>
                    <p>è¯„ä¼°æ‚¨çš„ç¡çœ çŠ¶å†µï¼Œè·å–æ”¹å–„ç¡çœ çš„ä¸“ä¸šå»ºè®®</p>
                    <button class="goto-btn" data-page="sleep">å¼€å§‹æµ‹è¯„</button>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">ğŸƒ</div>
                    <h3>è¿åŠ¨æ°´å¹³</h3>
                    <p>åˆ†ææ‚¨çš„è¿åŠ¨ä¹ æƒ¯ï¼Œåˆ¶å®šä¸ªæ€§åŒ–è¿åŠ¨è®¡åˆ’</p>
                    <button class="goto-btn" data-page="exercise">å¼€å§‹è¯„ä¼°</button>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">ğŸ</div>
                    <h3>é¥®é£Ÿå¥åº·</h3>
                    <p>è¯„ä¼°æ‚¨çš„é¥®é£Ÿä¹ æƒ¯ï¼Œæä¾›ç§‘å­¦è¥å…»å»ºè®®</p>
                    <button class="goto-btn" data-page="diet">å¼€å§‹åˆ†æ</button>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">ğŸ§ </div>
                    <h3>å¿ƒç†å¥åº·</h3>
                    <p>è¯„ä¼°å¿ƒç†çŠ¶æ€ï¼Œæä¾›æƒ…ç»ªç®¡ç†å»ºè®®</p>
                    <button class="goto-btn" data-page="mental">å¼€å§‹æµ‹è¯„</button>
                </div>
            </div>
        </div>



<!-- å†å²è®°å½•é¡µé¢ -->
<div id="history" class="page">
  <div class="card">
    <h1>å¥åº·æµ‹è¯„å†å²è®°å½•</h1>
    <div id="reports-list">
      <!-- æŠ¥å‘Šå°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
    </div>

    <div style="text-align: center; margin-top: 30px;">
      <button class="export-btn" onclick="exportData()">
        <i class="fas fa-download"></i> å¯¼å‡ºæ‰€æœ‰æ•°æ®
      </button>
        <button class="export-btn" style="background: #2196F3;" onclick="submitData()">
        <i class="fas fa-cloud-upload-alt"></i> æäº¤æ•°æ®
      </button>
      <p>æäº¤æ•°æ®å³è¡¨ç¤ºæ‚¨åŒæ„å°†åŒ¿åå¥åº·æ•°æ®ç”¨äºç ”ç©¶ç›®çš„</p>    </div>
  </div>
</div>


<!-- ç»¼åˆè¯„çº§é¡µé¢ -->
<div id="summary" class="page">
  <div class="card">
    <h1>å¥åº·ç»¼åˆè¯„çº§</h1>
    <div id="overall-rating">
      <!-- å†…å®¹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
    </div>

    <div class="progress-container" style="margin: 30px 0;">
      <div id="overall-progress" class="progress-bar"></div>
    </div>

    <div id="category-scores">
      <!-- å„åˆ†ç±»è¯„åˆ†å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
    </div>

    <div class="advice-section" id="summary-advice"></div>
      <div class="advice-section" id="improvement-advice" style="margin-top: 30px;"></div>
  </div>
</div>


        <!-- è¡€ç³–æ£€æµ‹é¡µé¢ -->
        <div id="blood-sugar" class="page">
            <div class="card">
                <h1>è¡€ç³–æ£€æµ‹å·¥å…·</h1>

                <div class="input-group">
                    <label for="bloodSugar">è¡€ç³–å€¼ï¼ˆmmol/Lï¼‰</label>
                    <input type="number" step="0.1" id="bloodSugar" placeholder="è¯·è¾“å…¥è¡€ç³–å€¼">
                </div>

                <div class="input-group">
                    <label for="measureTime">æµ‹é‡æ—¶é—´</label>
                    <select id="measureTime">
                        <option value="fasting">ç©ºè…¹</option>
                        <option value="afterMeal">é¤å2å°æ—¶</option>
                    </select>
                </div>

                <button onclick="checkSugar()">ç«‹å³æ£€æµ‹</button>

                <div id="sugar-result" class="result"></div>

                <div class="reference">
                    <h3>å‚è€ƒæ ‡å‡†</h3>
                    <p>ç©ºè…¹è¡€ç³–ï¼š3.9-6.1 mmol/L</p>
                    <p>é¤åè¡€ç³–ï¼š&lt;7.8 mmol/L</p>
                </div>
            </div>
        </div>

        <!-- BMIæ£€æµ‹é¡µé¢ -->
        <div id="bmi" class="page">
            <div class="card">
                <h1>BMIå¥åº·è®¡ç®—å™¨</h1>

                <div class="input-group">
                    <label for="height">èº«é«˜ï¼ˆå˜ç±³ï¼‰</label>
                    <input type="number" id="height" placeholder="è¯·è¾“å…¥èº«é«˜" min="1">
                </div>

                <div class="input-group">
                    <label for="weight">ä½“é‡ï¼ˆå…¬æ–¤ï¼‰</label>
                    <input type="number" id="weight" placeholder="è¯·è¾“å…¥ä½“é‡" min="1">
                </div>

                <div class="input-group">
                    <label for="age">å¹´é¾„</label>
                    <input type="number" id="age" min="10" max="100" placeholder="è¯·è¾“å…¥å¹´é¾„">
                </div>

                <div class="input-group">
                    <label for="occupation">èŒä¸šç±»å‹</label>
                    <select id="occupation">
                        <option value="sedentary">ä¹…åä¸Šç­æ—</option>
                        <option value="physical">ä½“åŠ›åŠ³åŠ¨è€…</option>
                        <option value="sports">ä½“è‚²ä»ä¸šè€…</option>
                    </select>
                </div>

                <button onclick="calculateBMI()">ç«‹å³è®¡ç®—</button>

                <div id="bmi-result" class="result"></div>

                <div class="bmi-scale">
                    <h3>BMIåˆ†ç±»æ ‡å‡†</h3>
                    <p>åç˜¦ &lt; 18.5 | æ­£å¸¸ 18.5-24 | è¿‡é‡ 24-28 | è‚¥èƒ– â‰¥28</p>
                </div>
            </div>
        </div>

<!-- ç¡çœ è´¨é‡é¡µé¢ -->
<div id="sleep" class="page">
    <div class="card">
        <h1>ğŸŒ™ åŒ¹å…¹å ¡ç¡çœ è´¨é‡æŒ‡æ•°(PSQI)æµ‹è¯„</h1>
        <p>è¯·æ ¹æ®è¿‡å»1ä¸ªæœˆçš„å®é™…æƒ…å†µå›ç­”ä»¥ä¸‹é—®é¢˜ï¼š</p>

        <form id="sleepForm">
            <!-- ç»„æˆéƒ¨åˆ†1ï¼šä¸»è§‚ç¡çœ è´¨é‡ -->
            <div class="question-group">
                <h3>1. æ€»ä½“ç¡çœ è´¨é‡è¯„ä»·</h3>
                <div class="question">
                    <label>æ‚¨å¦‚ä½•è¯„ä»·è¿‡å»1ä¸ªæœˆçš„ç¡çœ è´¨é‡ï¼Ÿ</label>
                    <select name="q1">
                        <option value="0">éå¸¸å¥½</option>
                        <option value="1">è¾ƒå¥½</option>
                        <option value="2">è¾ƒå·®</option>
                        <option value="3">éå¸¸å·®</option>
                    </select>
                </div>
            </div>

            <!-- ç»„æˆéƒ¨åˆ†2ï¼šç¡çœ æ½œä¼æœŸ -->
            <div class="question-group">
                <h3>2. å…¥ç¡æ—¶é—´</h3>
                <div class="question">
                    <label>è¿‡å»1ä¸ªæœˆï¼Œæ‚¨é€šå¸¸éœ€è¦å¤šé•¿æ—¶é—´æ‰èƒ½å…¥ç¡ï¼Ÿ</label>
                    <select name="q2">
                        <option value="0">â‰¤15åˆ†é’Ÿ</option>
                        <option value="1">16-30åˆ†é’Ÿ</option>
                        <option value="2">31-60åˆ†é’Ÿ</option>
                        <option value="3">>60åˆ†é’Ÿ</option>
                    </select>
                </div>

                <div class="question">
                    <label>è¿‡å»1ä¸ªæœˆï¼Œæ‚¨æ˜¯å¦å¾ˆéš¾åœ¨30åˆ†é’Ÿå†…å…¥ç¡ï¼Ÿ</label>
                    <select name="q3">
                        <option value="0">æ— </option>
                        <option value="1">æ¯å‘¨<1æ¬¡</option>
                        <option value="2">æ¯å‘¨1-2æ¬¡</option>
                        <option value="3">æ¯å‘¨â‰¥3æ¬¡</option>
                    </select>
                </div>
            </div>

            <!-- ç»„æˆéƒ¨åˆ†3ï¼šç¡çœ æŒç»­æ—¶é—´ -->
            <div class="question-group">
                <h3>3. ç¡çœ æ—¶é—´</h3>
                <div class="question">
                    <label>è¿‡å»1ä¸ªæœˆï¼Œæ‚¨æ¯æ™šå®é™…ç¡çœ æ—¶é—´æ˜¯å¤šå°‘ï¼Ÿ</label>
                    <select name="q4">
                        <option value="0">>7å°æ—¶</option>
                        <option value="1">6-7å°æ—¶</option>
                        <option value="2">5-6å°æ—¶</option>
                        <option value="3"><5å°æ—¶</option>
                    </select>
                </div>
            </div>

            <!-- ç»„æˆéƒ¨åˆ†4ï¼šç¡çœ æ•ˆç‡ -->
            <div class="question-group">
                <h3>4. ç¡çœ æ•ˆç‡ï¼ˆè®¡ç®—ç”¨ï¼‰</h3>
                <div class="question">
                    <label>é€šå¸¸æ‚¨å‡ ç‚¹ä¸ŠåºŠç¡è§‰ï¼Ÿ</label>
                    <input type="time" name="bedtime">
                </div>
                <div class="question">
                    <label>é€šå¸¸æ‚¨å‡ ç‚¹èµ·åºŠï¼Ÿ</label>
                    <input type="time" name="waketime">
                </div>
            </div>

            <!-- ç»„æˆéƒ¨åˆ†5ï¼šç¡çœ éšœç¢ -->
            <div class="question-group">
                <h3>5. ç¡çœ éšœç¢</h3>
                <div class="question">
                    <label>è¿‡å»1ä¸ªæœˆï¼Œæ‚¨æ˜¯å¦å› ä»¥ä¸‹é—®é¢˜å½±å“ç¡çœ ï¼š</label>
                </div>
                <div class="question">
                    <label>a. å¤œé—´æ˜“é†’æˆ–æ—©é†’</label>
                    <select name="q5a">
                        <option value="0">æ— </option>
                        <option value="1">æ¯å‘¨<1æ¬¡</option>
                        <option value="2">æ¯å‘¨1-2æ¬¡</option>
                        <option value="3">æ¯å‘¨â‰¥3æ¬¡</option>
                    </select>
                </div>
                <div class="question">
                    <label>b. å¤œé—´èµ·åºŠä¸Šå•æ‰€</label>
                    <select name="q5b">
                        <option value="0">æ— </option>
                        <option value="1">æ¯å‘¨<1æ¬¡</option>
                        <option value="2">æ¯å‘¨1-2æ¬¡</option>
                        <option value="3">æ¯å‘¨â‰¥3æ¬¡</option>
                    </select>
                </div>
                <div class="question">
                    <label>c. å‘¼å¸ä¸ç•…</label>
                    <select name="q5c">
                        <option value="0">æ— </option>
                        <option value="1">æ¯å‘¨<1æ¬¡</option>
                        <option value="2">æ¯å‘¨1-2æ¬¡</option>
                        <option value="3">æ¯å‘¨â‰¥3æ¬¡</option>
                    </select>
                </div>
                <div class="question">
                    <label>d. å’³å—½æˆ–æ‰“é¼¾</label>
                    <select name="q5d">
                        <option value="0">æ— </option>
                        <option value="1">æ¯å‘¨<1æ¬¡</option>
                        <option value="2">æ¯å‘¨1-2æ¬¡</option>
                        <option value="3">æ¯å‘¨â‰¥3æ¬¡</option>
                    </select>
                </div>
                <div class="question">
                    <label>e. æ„Ÿè§‰å†·</label>
                    <select name="q5e">
                        <option value="0">æ— </option>
                        <option value="1">æ¯å‘¨<1æ¬¡</option>
                        <option value="2">æ¯å‘¨1-2æ¬¡</option>
                        <option value="3">æ¯å‘¨â‰¥3æ¬¡</option>
                    </select>
                </div>
                <div class="question">
                    <label>f. æ„Ÿè§‰çƒ­</label>
                    <select name="q5f">
                        <option value="0">æ— </option>
                        <option value="1">æ¯å‘¨<1æ¬¡</option>
                        <option value="2">æ¯å‘¨1-2æ¬¡</option>
                        <option value="3">æ¯å‘¨â‰¥3æ¬¡</option>
                    </select>
                </div>
                <div class="question">
                    <label>g. åšå™©æ¢¦</label>
                    <select name="q5g">
                        <option value="0">æ— </option>
                        <option value="1">æ¯å‘¨<1æ¬¡</option>
                        <option value="2">æ¯å‘¨1-2æ¬¡</option>
                        <option value="3">æ¯å‘¨â‰¥3æ¬¡</option>
                    </select>
                </div>
                <div class="question">
                    <label>h. ç–¼ç—›ä¸é€‚</label>
                    <select name="q5h">
                        <option value="0">æ— </option>
                        <option value="1">æ¯å‘¨<1æ¬¡</option>
                        <option value="2">æ¯å‘¨1-2æ¬¡</option>
                        <option value="3">æ¯å‘¨â‰¥3æ¬¡</option>
                    </select>
                </div>
            </div>

            <!-- ç»„æˆéƒ¨åˆ†6ï¼šå‚¬çœ è¯ç‰©ä½¿ç”¨ -->
            <div class="question-group">
                <h3>6. å‚¬çœ è¯ç‰©ä½¿ç”¨</h3>
                <div class="question">
                    <label>è¿‡å»1ä¸ªæœˆï¼Œæ‚¨æ˜¯å¦ä½¿ç”¨è¯ç‰©å¸®åŠ©ç¡çœ ï¼Ÿ</label>
                    <select name="q6">
                        <option value="0">æ— </option>
                        <option value="1">æ¯å‘¨<1æ¬¡</option>
                        <option value="2">æ¯å‘¨1-2æ¬¡</option>
                        <option value="3">æ¯å‘¨â‰¥3æ¬¡</option>
                    </select>
                </div>
            </div>

            <!-- ç»„æˆéƒ¨åˆ†7ï¼šæ—¥é—´åŠŸèƒ½éšœç¢ -->
            <div class="question-group">
                <h3>7. æ—¥é—´åŠŸèƒ½éšœç¢</h3>
                <div class="question">
                    <label>è¿‡å»1ä¸ªæœˆï¼Œæ‚¨æ˜¯å¦éš¾ä»¥ä¿æŒæ¸…é†’çŠ¶æ€ï¼Ÿ</label>
                    <select name="q7a">
                        <option value="0">æ— </option>
                        <option value="1">æ¯å‘¨<1æ¬¡</option>
                        <option value="2">æ¯å‘¨1-2æ¬¡</option>
                        <option value="3">æ¯å‘¨â‰¥3æ¬¡</option>
                    </select>
                </div>
                <div class="question">
                    <label>è¿‡å»1ä¸ªæœˆï¼Œæ‚¨æ˜¯å¦ç²¾åŠ›ä¸è¶³ï¼Ÿ</label>
                    <select name="q7b">
                        <option value="0">æ— </option>
                        <option value="1">æ¯å‘¨<1æ¬¡</option>
                        <option value="2">æ¯å‘¨1-2æ¬¡</option>
                        <option value="3">æ¯å‘¨â‰¥3æ¬¡</option>
                    </select>
                </div>
            </div>

            <button type="button" onclick="calculatePSQI()">æŸ¥çœ‹åˆ†æ</button>
        </form>

        <div id="sleepResult" class="result"></div>
    </div>
</div>
<!-- é¥®é£Ÿå¥åº·é¡µé¢ -->
<div id="diet" class="page">
    <div class="card">
        <h1>ğŸ é¥®é£Ÿå¥åº·è¯„ä¼°</h1>
        <p>è¯·æ ¹æ®æ‚¨<strong>æœ€è¿‘ä¸€å‘¨</strong>çš„é¥®é£Ÿä¹ æƒ¯å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š</p>

        <form id="dietForm">
            <!-- åŸºæœ¬ä¿¡æ¯ -->
            <div class="question-group">
                <h3>1. åŸºæœ¬ä¿¡æ¯</h3>
                <div class="question">
                    <label>èº«é«˜(cm)</label>
                    <input type="number" name="height" min="120" max="250">
                </div>
                <div class="question">
                    <label>ä½“é‡(kg)</label>
                    <input type="number" name="weight" min="30" max="200">
                </div>
                <div class="question">
                    <label>å¹´é¾„</label>
                    <input type="number" name="age" min="18" max="100">
                </div>
                <div class="question">
                    <label>æ€§åˆ«</label>
                    <select name="gender">
                        <option value="male">ç”·</option>
                        <option value="female">å¥³</option>
                    </select>
                </div>
                <div class="question">
                    <label>æ—¥å¸¸æ´»åŠ¨æ°´å¹³</label>
                    <select name="activity">
                        <option value="sedentary">ä¹…å(åŠå…¬å®¤å·¥ä½œ)</option>
                        <option value="light">è½»åº¦æ´»åŠ¨(æ¯å‘¨1-2æ¬¡è¿åŠ¨)</option>
                        <option value="moderate">ä¸­åº¦æ´»åŠ¨(æ¯å‘¨3-5æ¬¡è¿åŠ¨)</option>
                        <option value="active">é«˜åº¦æ´»è·ƒ(ä½“åŠ›åŠ³åŠ¨æˆ–æ¯å¤©è¿åŠ¨)</option>
                    </select>
                </div>
            </div>

            <!-- é¥®é£Ÿå¤šæ ·æ€§è¯„ä¼° -->
            <div class="question-group">
                <h3>2. é¥®é£Ÿå¤šæ ·æ€§</h3>
                <p>è¿‡å»ä¸€å‘¨ï¼Œæ‚¨æ˜¯å¦ç»å¸¸é£Ÿç”¨ä»¥ä¸‹é£Ÿç‰©ï¼Ÿ</p>

                <div class="question">
                    <label>å…¨è°·ç‰©(ç³™ç±³ã€å…¨éº¦é¢åŒ…ç­‰)</label>
                    <select name="wholeGrain">
                        <option value="0">å‡ ä¹ä¸åƒ</option>
                        <option value="1">æ¯å‘¨1-2æ¬¡</option>
                        <option value="2">æ¯å‘¨3-5æ¬¡</option>
                        <option value="3">æ¯å¤©1æ¬¡ä»¥ä¸Š</option>
                    </select>
                </div>

                <div class="question">
                    <label>æ·±è‰²è”¬èœ(è èœã€è¥¿å…°èŠ±ç­‰)</label>
                    <select name="vegetables">
                        <option value="0">å‡ ä¹ä¸åƒ</option>
                        <option value="1">æ¯å‘¨1-2æ¬¡</option>
                        <option value="2">æ¯å‘¨3-5æ¬¡</option>
                        <option value="3">æ¯å¤©1æ¬¡ä»¥ä¸Š</option>
                    </select>
                </div>

                <div class="question">
                    <label>æ°´æœ</label>
                    <select name="fruits">
                        <option value="0">å‡ ä¹ä¸åƒ</option>
                        <option value="1">æ¯å‘¨1-2æ¬¡</option>
                        <option value="2">æ¯å‘¨3-5æ¬¡</option>
                        <option value="3">æ¯å¤©1æ¬¡ä»¥ä¸Š</option>
                    </select>
                </div>

                <div class="question">
                    <label>å¥¶åˆ¶å“(ç‰›å¥¶ã€é…¸å¥¶ç­‰)</label>
                    <select name="dairy">
                        <option value="0">å‡ ä¹ä¸åƒ</option>
                        <option value="1">æ¯å‘¨1-2æ¬¡</option>
                        <option value="2">æ¯å‘¨3-5æ¬¡</option>
                        <option value="3">æ¯å¤©1æ¬¡ä»¥ä¸Š</option>
                    </select>
                </div>

                <div class="question">
                    <label>ä¼˜è´¨è›‹ç™½(é±¼ã€è±†ã€è›‹ã€ç˜¦è‚‰)</label>
                    <select name="protein">
                        <option value="0">å‡ ä¹ä¸åƒ</option>
                        <option value="1">æ¯å‘¨1-2æ¬¡</option>
                        <option value="2">æ¯å‘¨3-5æ¬¡</option>
                        <option value="3">æ¯å¤©1æ¬¡ä»¥ä¸Š</option>
                    </select>
                </div>
            </div>

            <!-- é¥®é£Ÿä¹ æƒ¯è¯„ä¼° -->
            <div class="question-group">
                <h3>3. é¥®é£Ÿä¹ æƒ¯</h3>

                <div class="question">
                    <label>æ‚¨æ¯å¤©åƒå‡ é¤ï¼Ÿ</label>
                    <select name="mealsPerDay">
                        <option value="1">1-2é¤</option>
                        <option value="2">3é¤</option>
                        <option value="3">3é¤+1-2æ¬¡åŠ é¤</option>
                    </select>
                </div>

                <div class="question">
                    <label>æ—©é¤é€šå¸¸åŒ…å«å“ªäº›ï¼Ÿ(å¯å¤šé€‰)</label>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="breakfast" value="protein"> è›‹ç™½è´¨(è›‹/å¥¶/è±†)</label>
                        <label><input type="checkbox" name="breakfast" value="wholeGrain"> å…¨è°·ç‰©</label>
                        <label><input type="checkbox" name="breakfast" value="fruit"> æ°´æœ</label>
                        <label><input type="checkbox" name="breakfast" value="vegetable"> è”¬èœ</label>
                    </div>
                </div>

                <div class="question">
                    <label>æ‚¨åƒå¤–å–æˆ–å¤–å‡ºå°±é¤çš„é¢‘ç‡ï¼Ÿ</label>
                    <select name="eatOut">
                        <option value="0">å‡ ä¹ä¸åƒ</option>
                        <option value="1">æ¯å‘¨1-2æ¬¡</option>
                        <option value="2">æ¯å‘¨3-5æ¬¡</option>
                        <option value="3">æ¯å¤©1æ¬¡ä»¥ä¸Š</option>
                    </select>
                </div>

                <div class="question">
                    <label>æ‚¨åƒé›¶é£Ÿ(å«ç³–é¥®æ–™ã€ç”œç‚¹ç­‰)çš„é¢‘ç‡ï¼Ÿ</label>
                    <select name="snacks">
                        <option value="0">å‡ ä¹ä¸åƒ</option>
                        <option value="1">æ¯å‘¨1-2æ¬¡</option>
                        <option value="2">æ¯å‘¨3-5æ¬¡</option>
                        <option value="3">æ¯å¤©1æ¬¡ä»¥ä¸Š</option>
                    </select>
                </div>

                <div class="question">
                    <label>æ‚¨æ¯å¤©çš„é¥®æ°´é‡(çº¦å¤šå°‘æ¯ï¼Œ250ml/æ¯)?</label>
                    <select name="water">
                        <option value="0">å°‘äº4æ¯</option>
                        <option value="1">4-6æ¯</option>
                        <option value="2">7-8æ¯</option>
                        <option value="3">8æ¯ä»¥ä¸Š</option>
                    </select>
                </div>
            </div>

            <button type="button" onclick="assessDiet()">è·å–é¥®é£Ÿè¯„ä¼°</button>
        </form>

        <div id="dietResult" class="result"></div>
    </div>
</div>

<!-- å¿ƒç†å¥åº·é¡µé¢ -->
<div id="mental" class="page">
    <div class="card">
        <h1>ğŸ§  å¿ƒç†å¥åº·è¯„ä¼°</h1>
        <p>è¯·æ ¹æ®<strong>æœ€è¿‘ä¸€å‘¨</strong>çš„æ„Ÿå—ï¼Œé€‰æ‹©æœ€ç¬¦åˆæ‚¨æƒ…å†µçš„é€‰é¡¹ï¼š</p>

        <form id="mentalForm">
            <!-- DASS-21æŠ‘éƒéƒ¨åˆ† -->
            <div class="question-group">
                <h3>æƒ…ç»ªçŠ¶æ€</h3>
                <div class="question">
                    <label>1. æˆ‘æ„Ÿåˆ°æƒ…ç»ªä½è½</label>
                    <select name="depression1">
                        <option value="0">å®Œå…¨ä¸ç¬¦åˆ</option>
                        <option value="1">æœ‰æ—¶ç¬¦åˆ</option>
                        <option value="2">ç»å¸¸ç¬¦åˆ</option>
                        <option value="3">æ€»æ˜¯ç¬¦åˆ</option>
                    </select>
                </div>
                <div class="question">
                    <label>2. æˆ‘å¯¹äº‹æƒ…å¤±å»å…´è¶£</label>
                    <select name="depression2">
                        <option value="0">å®Œå…¨ä¸ç¬¦åˆ</option>
                        <option value="1">æœ‰æ—¶ç¬¦åˆ</option>
                        <option value="2">ç»å¸¸ç¬¦åˆ</option>
                        <option value="3">æ€»æ˜¯ç¬¦åˆ</option>
                    </select>
                </div>
                <div class="question">
                    <label>3. æˆ‘è§‰å¾—æœªæ¥æ²¡æœ‰å¸Œæœ›</label>
                    <select name="depression3">
                        <option value="0">å®Œå…¨ä¸ç¬¦åˆ</option>
                        <option value="1">æœ‰æ—¶ç¬¦åˆ</option>
                        <option value="2">ç»å¸¸ç¬¦åˆ</option>
                        <option value="3">æ€»æ˜¯ç¬¦åˆ</option>
                    </select>
                </div>
            </div>

            <!-- DASS-21ç„¦è™‘éƒ¨åˆ† -->
            <div class="question-group">
                <h3>ç„¦è™‘æ„Ÿå—</h3>
                <div class="question">
                    <label>4. æˆ‘æ„Ÿåˆ°ç´§å¼ ä¸å®‰</label>
                    <select name="anxiety1">
                        <option value="0">å®Œå…¨ä¸ç¬¦åˆ</option>
                        <option value="1">æœ‰æ—¶ç¬¦åˆ</option>
                        <option value="2">ç»å¸¸ç¬¦åˆ</option>
                        <option value="3">æ€»æ˜¯ç¬¦åˆ</option>
                    </select>
                </div>
                <div class="question">
                    <label>5. æˆ‘æ‹…å¿ƒå¾ˆå¤šäº‹æƒ…</label>
                    <select name="anxiety2">
                        <option value="0">å®Œå…¨ä¸ç¬¦åˆ</option>
                        <option value="1">æœ‰æ—¶ç¬¦åˆ</option>
                        <option value="2">ç»å¸¸ç¬¦åˆ</option>
                        <option value="3">æ€»æ˜¯ç¬¦åˆ</option>
                    </select>
                </div>
                <div class="question">
                    <label>6. æˆ‘æ„Ÿåˆ°ææ…Œ</label>
                    <select name="anxiety3">
                        <option value="0">å®Œå…¨ä¸ç¬¦åˆ</option>
                        <option value="1">æœ‰æ—¶ç¬¦åˆ</option>
                        <option value="2">ç»å¸¸ç¬¦åˆ</option>
                        <option value="3">æ€»æ˜¯ç¬¦åˆ</option>
                    </select>
                </div>
            </div>

            <!-- DASS-21å‹åŠ›éƒ¨åˆ† -->
            <div class="question-group">
                <h3>å‹åŠ›ååº”</h3>
                <div class="question">
                    <label>7. æˆ‘å¾ˆéš¾æ”¾æ¾</label>
                    <select name="stress1">
                        <option value="0">å®Œå…¨ä¸ç¬¦åˆ</option>
                        <option value="1">æœ‰æ—¶ç¬¦åˆ</option>
                        <option value="2">ç»å¸¸ç¬¦åˆ</option>
                        <option value="3">æ€»æ˜¯ç¬¦åˆ</option>
                    </select>
                </div>
                <div class="question">
                    <label>8. æˆ‘å®¹æ˜“çƒ¦èº</label>
                    <select name="stress2">
                        <option value="0">å®Œå…¨ä¸ç¬¦åˆ</option>
                        <option value="1">æœ‰æ—¶ç¬¦åˆ</option>
                        <option value="2">ç»å¸¸ç¬¦åˆ</option>
                        <option value="3">æ€»æ˜¯ç¬¦åˆ</option>
                    </select>
                </div>
                <div class="question">
                    <label>9. æˆ‘è§‰å¾—è‡ªå·±å¾ˆå®¹æ˜“è¢«æ¿€æ€’</label>
                    <select name="stress3">
                        <option value="0">å®Œå…¨ä¸ç¬¦åˆ</option>
                        <option value="1">æœ‰æ—¶ç¬¦åˆ</option>
                        <option value="2">ç»å¸¸ç¬¦åˆ</option>
                        <option value="3">æ€»æ˜¯ç¬¦åˆ</option>
                    </select>
                </div>
            </div>

            <!-- è‡ªæ€é£é™©è¯„ä¼° -->
            <div class="question-group warning-box">
                <h3>é‡è¦é—®é¢˜</h3>
                <div class="question">
                    <label>æœ€è¿‘æ˜¯å¦æœ‰ä¼¤å®³è‡ªå·±çš„æƒ³æ³•ï¼Ÿ</label>
                    <select name="suicideRisk" id="suicideRisk">
                        <option value="0">å®Œå…¨æ²¡æœ‰</option>
                        <option value="1">å¶å°”æƒ³è¿‡ä½†ä¸ä¼šå®æ–½</option>
                        <option value="2">è®¤çœŸè€ƒè™‘è¿‡</option>
                        <option value="3">æœ‰å…·ä½“è®¡åˆ’</option>
                    </select>
                </div>
            </div>

            <button type="button" onclick="assessMentalHealth()">è·å–è¯„ä¼°ç»“æœ</button>
        </form>

        <div id="mentalResult" class="result"></div>
        <div id="emergencyContact" class="emergency" style="display:none">
            <h3>âš ï¸ ç´§æ€¥å¸®åŠ©èµ„æº</h3>
            <p>å¦‚æœæ‚¨æ„Ÿåˆ°æåº¦ç—›è‹¦æˆ–æœ‰è‡ªä¼¤æƒ³æ³•ï¼š</p>
            <ul>
                <li>å¿ƒç†æ´åŠ©çƒ­çº¿ï¼š12320ï¼ˆå…¨å›½24å°æ—¶ï¼‰</li>
                <li>åŒ—äº¬å¿ƒç†å±æœºå¹²é¢„ä¸­å¿ƒï¼š010-82951332</li>
                <li>å¸Œæœ›24çƒ­çº¿ï¼ˆè‡ªæ€é˜²æ²»ï¼‰ï¼š400-161-9995</li>
                <li>ç«‹å³å‰å¾€æœ€è¿‘çš„åŒ»é™¢æ€¥è¯Šç§‘</li>
            </ul>
            <p>æ‚¨ä¸æ˜¯ä¸€ä¸ªäººï¼Œå¸®åŠ©å°±åœ¨èº«è¾¹ã€‚</p>
        </div>
    </div>
</div>

       <!-- è¿åŠ¨æ°´å¹³é¡µé¢ -->
<div id="exercise" class="page">
    <div class="card">
        <h1>ğŸƒ è¿åŠ¨æ°´å¹³è¯„ä¼°</h1>
        <p>è¯·å›å¿†è¿‡å»7å¤©å†…æ‚¨çš„ä½“åŠ›æ´»åŠ¨æƒ…å†µï¼š</p>

        <form id="exerciseForm">
            <!-- æœ‰æ°§è¿åŠ¨éƒ¨åˆ† -->
            <div class="question-group">
                <h3>1. é«˜å¼ºåº¦æ´»åŠ¨</h3>
                <p>å¦‚è·‘æ­¥ã€å¿«é€Ÿæ¸¸æ³³ã€ç«æŠ€è¿åŠ¨ã€æœ‰æ°§æ“ã€å¿«é€Ÿéª‘è¡Œç­‰</p>

                <div class="question">
                    <label>è¿‡å»7å¤©ï¼Œæ‚¨è¿›è¡Œäº†å‡ å¤©é«˜å¼ºåº¦æ´»åŠ¨ï¼Ÿ</label>
                    <select name="vigorousDays">
                        <option value="0">0å¤©</option>
                        <option value="1">1å¤©</option>
                        <option value="2">2å¤©</option>
                        <option value="3">3å¤©</option>
                        <option value="4">4å¤©</option>
                        <option value="5">5å¤©</option>
                        <option value="6">6å¤©</option>
                        <option value="7">7å¤©</option>
                    </select>
                </div>

                <div class="question">
                    <label>åœ¨è¿™äº›å¤©ï¼Œé€šå¸¸æ¯å¤©è¿›è¡Œå¤šé•¿æ—¶é—´ï¼Ÿ</label>
                    <div class="input-with-unit">
                        <input type="number" name="vigorousMinutes" min="0" max="300" placeholder="åˆ†é’Ÿ">
                        <span>åˆ†é’Ÿ/å¤©</span>
                    </div>
                </div>
            </div>

            <!-- ä¸­ç­‰å¼ºåº¦è¿åŠ¨éƒ¨åˆ† -->
            <div class="question-group">
                <h3>2. ä¸­ç­‰å¼ºåº¦æ´»åŠ¨</h3>
                <p>å¦‚å¿«èµ°ã€ä¼‘é—²æ¸¸æ³³ã€æ…¢é€Ÿéª‘è¡Œã€ä¹’ä¹“çƒã€ç‘œä¼½ç­‰</p>

                <div class="question">
                    <label>è¿‡å»7å¤©ï¼Œæ‚¨è¿›è¡Œäº†å‡ å¤©ä¸­ç­‰å¼ºåº¦æ´»åŠ¨ï¼Ÿ</label>
                    <select name="moderateDays">
                        <option value="0">0å¤©</option>
                        <option value="1">1å¤©</option>
                        <option value="2">2å¤©</option>
                        <option value="3">3å¤©</option>
                        <option value="4">4å¤©</option>
                        <option value="5">5å¤©</option>
                        <option value="6">6å¤©</option>
                        <option value="7">7å¤©</option>
                    </select>
                </div>

                <div class="question">
                    <label>åœ¨è¿™äº›å¤©ï¼Œé€šå¸¸æ¯å¤©è¿›è¡Œå¤šé•¿æ—¶é—´ï¼Ÿ</label>
                    <div class="input-with-unit">
                        <input type="number" name="moderateMinutes" min="0" max="300" placeholder="åˆ†é’Ÿ">
                        <span>åˆ†é’Ÿ/å¤©</span>
                    </div>
                </div>
            </div>

            <!-- æ­¥è¡Œéƒ¨åˆ† -->
            <div class="question-group">
                <h3>3. æ­¥è¡Œ</h3>
                <p>åŒ…æ‹¬é€šå‹¤æ­¥è¡Œã€æ•£æ­¥ç­‰ï¼ˆæ¯æ¬¡è‡³å°‘10åˆ†é’Ÿï¼‰</p>

                <div class="question">
                    <label>è¿‡å»7å¤©ï¼Œæ‚¨æ­¥è¡Œäº†å¤šå°‘å¤©ï¼Ÿ</label>
                    <select name="walkingDays">
                        <option value="0">0å¤©</option>
                        <option value="1">1å¤©</option>
                        <option value="2">2å¤©</option>
                        <option value="3">3å¤©</option>
                        <option value="4">4å¤©</option>
                        <option value="5">5å¤©</option>
                        <option value="6">6å¤©</option>
                        <option value="7">7å¤©</option>
                    </select>
                </div>

                <div class="question">
                    <label>åœ¨è¿™äº›å¤©ï¼Œé€šå¸¸æ¯å¤©æ­¥è¡Œå¤šé•¿æ—¶é—´ï¼Ÿ</label>
                    <div class="input-with-unit">
                        <input type="number" name="walkingMinutes" min="0" max="300" placeholder="åˆ†é’Ÿ">
                        <span>åˆ†é’Ÿ/å¤©</span>
                    </div>
                </div>
            </div>

            <!-- ä¹…åæ—¶é—´ -->
            <div class="question-group">
                <h3>4. ä¹…åæ—¶é—´</h3>
                <p>åŒ…æ‹¬åç€å·¥ä½œã€çœ‹ç”µè§†ã€ä½¿ç”¨ç”µè„‘ç­‰</p>

                <div class="question">
                    <label>è¿‡å»7å¤©ï¼Œæ¯å¤©åç€çš„æ—¶é—´å¤§çº¦æ˜¯å¤šå°‘ï¼Ÿ</label>
                    <div class="input-with-unit">
                        <input type="number" name="sittingHours" min="0" max="24" placeholder="å°æ—¶">
                        <span>å°æ—¶/å¤©</span>
                    </div>
                </div>
            </div>

            <!-- ä¸ªäººåŸºæœ¬ä¿¡æ¯ -->
            <div class="question-group">
                <h3>5. æ‚¨çš„ä¿¡æ¯</h3>

                <div class="question">
                    <label>å¹´é¾„</label>
                    <input type="number" name="age" min="18" max="100">
                </div>

                <div class="question">
                    <label>æ€§åˆ«</label>
                    <select name="gender">
                        <option value="male">ç”·</option>
                        <option value="female">å¥³</option>
                    </select>
                </div>

                <div class="question">
                    <label>æ˜¯å¦æœ‰æ…¢æ€§ç—…æˆ–è¿åŠ¨é™åˆ¶ï¼Ÿ</label>
                    <select name="healthCondition">
                        <option value="none">æ— </option>
                        <option value="cardiovascular">å¿ƒè¡€ç®¡ç–¾ç—…</option>
                        <option value="musculoskeletal">è‚Œè‚‰éª¨éª¼é—®é¢˜</option>
                        <option value="metabolic">ä»£è°¢æ€§ç–¾ç—…(å¦‚ç³–å°¿ç—…)</option>
                        <option value="other">å…¶ä»–</option>
                    </select>
                </div>
            </div>

            <button type="button" onclick="assessExerciseLevel()">è¯„ä¼°è¿åŠ¨æ°´å¹³</button>
        </form>

        <div id="exerciseResult" class="result"></div>
    </div>
</div>

          <footer>
            <p>Â© 2025 æ‚¦ä¹‹å¿ƒå¥åº·æ£€æµ‹ä¸­å¿ƒ | æœ¬å·¥å…·æä¾›çš„ä¿¡æ¯ä»…ä¾›å‚è€ƒï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šåŒ»ç–—å»ºè®®ï¼Œå¦‚æœ‰ç´§æ€¥æƒ…å†µè¯·åŠæ—¶å°±åŒ»</p>
             <p>è”ç³»æˆ‘ä»¬ï¼š <i class="fas fa-phone"></i>19133232635  | <i class="fas fa-envelope"></i>3107861524@qq.com </p>
               <p>éšç§å£°æ˜ï¼šæ‚¨çš„æ•°æ®ä»…ç”¨äºå¥åº·è¯„ä¼°ï¼Œæˆ‘ä»¬ä¼šåŒ¿ååŒ–å¤„ç†æ‰€æœ‰æ•°æ®</p>
        </footer>
          </div>
<script>

// ===== å¥åº·æ•°æ®å­˜å‚¨ç³»ç»Ÿ =====
// åœ¨é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
document.addEventListener('DOMContentLoaded', function() {
    // ç”¨æˆ·IDç”Ÿæˆ
    let userId = localStorage.getItem('healthUserId');
    if (!userId) {
        userId = 'user_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('healthUserId', userId);
    }

    // åˆå§‹åŒ–æ•°æ®ç»“æ„
    window.healthData = JSON.parse(localStorage.getItem('healthData')) || {
        userId: userId,
        reports: []
    };

    // ä¿å­˜æŠ¥å‘Šå‡½æ•°
    window.saveReport = function(type, score, details) {
        healthData.reports.push({
            type,
            score,
            details,
            timestamp: new Date().toISOString()
        });
        localStorage.setItem('healthData', JSON.stringify(healthData));
    };

    // è·å–æŠ¥å‘Šåç§°
    window.getReportName = function(type) {
        const names = {
            'blood-sugar': 'è¡€ç³–æ£€æµ‹',
            'bmi': 'BMIè®¡ç®—',
            'sleep': 'ç¡çœ è´¨é‡',
            'exercise': 'è¿åŠ¨æ°´å¹³',
            'diet': 'é¥®é£Ÿå¥åº·',
            'mental': 'å¿ƒç†å¥åº·'
        };
        return names[type] || type;
    };

    // åŠ è½½å†å²è®°å½•
    window.loadReports = function() {
        const container = document.getElementById('reports-list');
        const reports = healthData.reports;

        if (!reports || reports.length === 0) {
            container.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-file-alt"></i>
                    <h3>æš‚æ— æµ‹è¯„è®°å½•</h3>
                    <p>å®Œæˆæµ‹è¯„åï¼Œæ‚¨çš„è®°å½•å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</p>
                </div>
            `;
            return;
        }

        // æŒ‰æ—¶é—´å€’åºæ’åº
        const sortedReports = [...reports].sort((a, b) =>
            new Date(b.timestamp) - new Date(a.timestamp)
        );

        container.innerHTML = sortedReports.map(report => {
            const date = new Date(report.timestamp);
            const typeName = getReportName(report.type);

            return `
                <div class="report-item">
                    <div class="report-header">
                        <div class="report-title">${typeName}</div>
                        <div class="report-score">${report.score.toFixed(0)}</div>
                    </div>

                    <div class="report-time">${date.toLocaleString()}</div>

                    <div class="report-details">
                        ${renderReportDetails(report)}
                    </div>
                </div>
            `;
        }).join('');
    };

    // æ¸²æŸ“æŠ¥å‘Šè¯¦æƒ…
    window.renderReportDetails = function(report) {
        switch(report.type) {
            case 'blood-sugar':
                return `
                    <div class="detail-item">
                        <div class="detail-label">è¡€ç³–å€¼</div>
                        <div class="detail-value">${report.details.value.toFixed(1)} mmol/L</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">æµ‹é‡æ—¶é—´</div>
                        <div class="detail-value">${report.details.time === 'fasting' ? 'ç©ºè…¹' : 'é¤å'}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">çŠ¶æ€</div>
                        <div class="detail-value">${report.details.isNormal ? 'æ­£å¸¸' : 'å¼‚å¸¸'}</div>
                    </div>
                `;

            case 'bmi':
                return `
                    <div class="detail-item">
                        <div class="detail-label">èº«é«˜</div>
                        <div class="detail-value">${report.details.height} cm</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">ä½“é‡</div>
                        <div class="detail-value">${report.details.weight} kg</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">BMI</div>
                        <div class="detail-value">${report.details.bmi.toFixed(1)}</div>
                    </div>
                `;

            // å…¶ä»–ç±»å‹çš„æŠ¥å‘Šè¯¦æƒ…ç±»ä¼¼å¤„ç†...
            default:
                return '';
        }
    };


   // ç»¼åˆè¯„çº§è®¡ç®— - ä¿®å¤ç‰ˆæœ¬
window.calculateOverallRating = function() {
    const scores = {
        'blood-sugar': 0.2,
        'bmi': 0.2,
        'sleep': 0.15,
        'exercise': 0.15,
        'diet': 0.15,
        'mental': 0.15
    };

    // è·å–æ¯ä¸ªç±»å‹çš„æœ€æ–°æŠ¥å‘Š
    const latestReports = {};
    healthData.reports.forEach(report => {
        if (!latestReports[report.type] ||
            new Date(report.timestamp) > new Date(latestReports[report.type].timestamp)) {
            latestReports[report.type] = report;
        }
    });

    let total = 0;
    let weightSum = 0;

    // åªè®¡ç®—æœ€æ–°æŠ¥å‘Š
    Object.keys(scores).forEach(type => {
        if (latestReports[type]) {
            total += latestReports[type].score * scores[type];
            weightSum += scores[type];
        }
    });

    const overallScore = weightSum > 0 ? total / weightSum : 0;
    const rating = getRatingLevel(overallScore);

    // æ·»åŠ å¯è§†åŒ–è¿›åº¦æ¡
    document.getElementById('overall-rating').innerHTML = `
        <div class="result" style="text-align: center;">
            <h2>ç»¼åˆå¾—åˆ†: ${overallScore.toFixed(1)}</h2>
            <h3 style="color: ${getRatingColor(overallScore)}">è¯„çº§: ${rating}</h3>
            <div class="progress-container" style="margin: 20px auto; width: 80%;">
                <div class="progress-bar" style="width: ${overallScore}%; background-color: ${getRatingColor(overallScore)};"></div>
            </div>
        </div>
    `;

    // æ·»åŠ å„ç»´åº¦è¯„åˆ†å±•ç¤º
    showCategoryScores(latestReports);
};

// è·å–è¯„çº§é¢œè‰²
window.getRatingColor = function(score) {
    if (score >= 90) return '#4CAF50';
    if (score >= 80) return '#8BC34A';
    if (score >= 70) return '#FFC107';
    if (score >= 60) return '#FF9800';
    return '#F44336';
};

// æ˜¾ç¤ºå„åˆ†ç±»è¯„åˆ†
window.showCategoryScores = function(latestReports) {
    const container = document.getElementById('category-scores');
    if (!container) return;

    let html = `<div style="margin-top: 30px;">
                <h3>å„å¥åº·ç»´åº¦è¯„åˆ†</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">`;

    const categories = [
        { id: 'blood-sugar', name: 'è¡€ç³–æ£€æµ‹', icon: 'ğŸ©¸' },
        { id: 'bmi', name: 'BMIè®¡ç®—', icon: 'âš–ï¸' },
        { id: 'sleep', name: 'ç¡çœ è´¨é‡', icon: 'ğŸŒ™' },
        { id: 'exercise', name: 'è¿åŠ¨æ°´å¹³', icon: 'ğŸƒ' },
        { id: 'diet', name: 'é¥®é£Ÿå¥åº·', icon: 'ğŸ' },
        { id: 'mental', name: 'å¿ƒç†å¥åº·', icon: 'ğŸ§ ' }
    ];

    categories.forEach(cat => {
        const report = latestReports[cat.id];
        const score = report ? report.score : 0;
        const color = getRatingColor(score);

        html += `
            <div style="background: white; border-radius: 10px; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-left: 4px solid ${color}">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.5rem;">${cat.icon}</span>
                    <h4 style="margin: 0;">${cat.name}</h4>
                </div>
                <div style="margin-top: 10px;">
                    <div style="height: 10px; background: #e0e0e0; border-radius: 5px; margin: 10px 0;">
                        <div style="height: 100%; border-radius: 5px; background-color: ${color}; width: ${score}%"></div>
                    </div>
                    <p style="margin: 5px 0; text-align: center; font-weight: bold; color: ${color}">${score.toFixed(1)}</p>
                </div>
            </div>
        `;
    });

    html += `</div></div>`;
    container.innerHTML = html;
};

// è¯„çº§ç­‰çº§
window.getRatingLevel = function(score) {
    if (score >= 90) return 'ä¼˜ç§€';
    if (score >= 80) return 'è‰¯å¥½';
    if (score >= 70) return 'ä¸­ç­‰';
    if (score >= 60) return 'ä¸€èˆ¬';
    return 'éœ€è¦æ”¹å–„';
};


    // æ•°æ®å¯¼å‡ºåŠŸèƒ½
    window.exportData = function() {
        const dataStr = JSON.stringify(healthData, null, 2);
        const blob = new Blob([dataStr], {type: 'application/json'});
        const url = URL.createObjectURL(blob);

        const a = document.createElement('a');
        a.href = url;
        a.download = `health-report-${userId}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    };
});



// ===== æ·»åŠ æ•°æ®æäº¤åŠŸèƒ½ =====
    window.submitData = function() {
        // æ£€æŸ¥æ˜¯å¦æœ‰æ•°æ®å¯æäº¤
        if (!healthData.reports || healthData.reports.length === 0) {
            alert('æ²¡æœ‰æ•°æ®å¯æäº¤ï¼è¯·å…ˆå®Œæˆè‡³å°‘ä¸€é¡¹å¥åº·è¯„ä¼°ã€‚');
            return;
        }

        const dataStr = JSON.stringify(healthData, null, 2);

         // åˆ›å»ºGitHub Issueçš„å†…å®¹
    const title = `å¥åº·æ•°æ®æäº¤ - ç”¨æˆ·ID: ${healthData.userId}`;
    const body = "```json\n" + JSON.stringify(healthData, null, 2) + "\n```";

    // ç”¨æˆ·å°†è¢«é‡å®šå‘åˆ°GitHub Issueåˆ›å»ºé¡µé¢
    const githubUrl = `https://github.com/YOUR_USERNAME/YOUR_REPO/issues/new` +
        `?title=${encodeURIComponent(title)}` +
        `&body=${encodeURIComponent(body)}` +
        `&labels=data-submission`;

    // åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€GitHub Issueåˆ›å»ºé¡µé¢
    window.open(githubUrl, '_blank');
};



// é¡µé¢å¯¼èˆªåŠŸèƒ½
document.addEventListener('DOMContentLoaded', function() {
    // å¤„ç†å¯¼èˆªé“¾æ¥ç‚¹å‡»
    document.querySelectorAll('.nav-link, .goto-btn').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();

            // æ›´æ–°å¯¼èˆªçŠ¶æ€
            document.querySelectorAll('.nav-link').forEach(nav => {
                nav.classList.remove('active');
            });

            if(this.classList.contains('nav-link')) {
                this.classList.add('active');
            }

            // æ˜¾ç¤ºç›®æ ‡é¡µé¢
            const targetPage = this.dataset.page;
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(targetPage).classList.add('active');

            // æ»šåŠ¨åˆ°é¡¶éƒ¨
            window.scrollTo(0, 0);

            if (targetPage === 'history') {
                loadReports();
            }
            if (targetPage === 'summary') {
                calculateOverallRating();
            }
        });
    });
});


// è¡€ç³–æ£€æµ‹åŠŸèƒ½
function checkSugar() {
    const bloodSugar = parseFloat(document.getElementById('bloodSugar').value);
    const measureTime = document.getElementById('measureTime').value;
    const resultDiv = document.getElementById('sugar-result');

    if (!bloodSugar || bloodSugar <= 0) {
        alert("è¯·è¾“å…¥æœ‰æ•ˆçš„è¡€ç³–å€¼");
        return;
    }

    let normalRange, isNormal;
    if (measureTime === 'fasting') {
        normalRange = "3.9-6.1 mmol/L";
        isNormal = bloodSugar >= 3.9 && bloodSugar <= 6.1;
    } else {
        normalRange = "<7.8 mmol/L";
        isNormal = bloodSugar < 7.8;
    }

    resultDiv.style.display = 'block';
    resultDiv.innerHTML = `
        <h2>æ£€æµ‹ç»“æœï¼š${isNormal ? '<span style="color:#2E7D32">æ­£å¸¸</span>' : '<span style="color:#d32f2f">å¼‚å¸¸</span>'}</h2>
        <p>è¡€ç³–å€¼ï¼š${bloodSugar.toFixed(1)} mmol/Lï¼ˆ${measureTime === 'fasting' ? 'ç©ºè…¹' : 'é¤å'}ï¼‰</p>
        <p>å‚è€ƒèŒƒå›´ï¼š${normalRange}</p>
        ${generateSugarAdvice(bloodSugar, measureTime)}
    `;
    resultDiv.style.backgroundColor = isNormal ? '#e8f5e9' : '#ffebee';
    const sugarScore = isNormal ? 100 : 60;
    saveReport('blood-sugar', sugarScore, {
        value: bloodSugar,
        time: measureTime,
        isNormal: isNormal
    });
}

function generateSugarAdvice(value, time) {
    let adviceHTML = '<div class="advice-section">';

    // ç´§æ€¥è­¦å‘Š
    if (value > 13.9) {
        adviceHTML += `
            <div class="warning">
                âš ï¸ è¡€ç³–å€¼è¿‡é«˜ï¼å¯èƒ½å‡ºç°é…®ç—‡é…¸ä¸­æ¯’é£é™©ï¼Œè¯·ç«‹å³å°±åŒ»ï¼
            </div>
        `;
    }

    // è¿åŠ¨å»ºè®®
    adviceHTML += `<div class="exercise-advice">`;
    if (time === 'afterMeal') {
        if (value >= 7.8 && value <= 10) {
            adviceHTML += `
                <h3>è¿åŠ¨å»ºè®®ï¼š</h3>
                <ul>
                    <li>é¤å30åˆ†é’Ÿå¼€å§‹è¿åŠ¨ï¼ŒæŒç»­æ—¶é—´20-30åˆ†é’Ÿ</li>
                    <li>æ¨èè¿åŠ¨ï¼šå¿«èµ°ï¼ˆæ¯åˆ†é’Ÿ100-120æ­¥ï¼‰</li>
                    <li>é¿å…é«˜å¼ºåº¦è¿åŠ¨ï¼ˆå¯èƒ½å¼•èµ·è¡€ç³–æ³¢åŠ¨ï¼‰</li>
                </ul>
            `;
        } else if (value > 10) {
            adviceHTML += `
                <h3>è¿åŠ¨å»ºè®®ï¼š</h3>
                <ul>
                    <li>é¤å1å°æ—¶è¿›è¡Œä½å¼ºåº¦è¿åŠ¨ï¼ˆå¦‚æ•£æ­¥ï¼‰</li>
                    <li>æ¯æ¬¡è¿åŠ¨æ—¶é—´15-20åˆ†é’Ÿ</li>
                    <li>è¿åŠ¨å‰æ£€æµ‹è¡€ç³–ï¼Œ<13.9mmol/Læ–¹å¯è¿åŠ¨</li>
                </ul>
            `;
        }
    } else {
        if (value >= 6.1 && value <= 7.0) {
            adviceHTML += `
                <h3>è¿åŠ¨å»ºè®®ï¼š</h3>
                <ul>
                    <li>æ¯æ—¥è§„å¾‹è¿åŠ¨30-45åˆ†é’Ÿ</li>
                    <li>æ¨èï¼šéª‘è‡ªè¡Œè½¦ã€æ¸¸æ³³ç­‰ä¸­ç­‰å¼ºåº¦è¿åŠ¨</li>
                    <li>æ¯å‘¨è‡³å°‘5å¤©è¿åŠ¨</li>
                </ul>
            `;
        }
    }
    adviceHTML += `</div>`;

    // é¥®é£Ÿå»ºè®®
    adviceHTML += `<div class="diet-advice">`;
    if (time === 'fasting') {
        adviceHTML += `
            <h3>é¥®é£Ÿå»ºè®®ï¼š</h3>
            <ul>
                ${value > 6.1 ? `
                    <li>æ§åˆ¶æ€»çƒ­é‡æ‘„å…¥ï¼ˆæ¯æ—¥å‡å°‘300-500å¤§å¡ï¼‰</li>
                    <li>é€‰æ‹©ä½GIä¸»é£Ÿï¼ˆç³™ç±³ã€å…¨éº¦é¢åŒ…ç­‰ï¼‰</li>
                    <li>å¢åŠ è†³é£Ÿçº¤ç»´ï¼ˆæ¯æ—¥è”¬èœâ‰¥500gï¼‰</li>
                ` : `
                    <li>ä¿æŒä¸‰é¤å®šæ—¶å®šé‡</li>
                    <li>ä¼˜è´¨è›‹ç™½æ‘„å…¥ï¼ˆé¸¡è›‹ã€é±¼è‚‰ã€è±†åˆ¶å“ï¼‰</li>
                    <li>é™åˆ¶ç²¾åˆ¶ç³–å’ŒåŠ å·¥é£Ÿå“</li>
                `}
            </ul>
        `;
    } else {
        adviceHTML += `
            <h3>é¥®é£Ÿå»ºè®®ï¼š</h3>
            <ul>
                ${value >= 7.8 ? `
                    <li>æ§åˆ¶ç¢³æ°´åŒ–åˆç‰©æ‘„å…¥ï¼ˆæ¯é¤â‰¤60gï¼‰</li>
                    <li>é‡‡ç”¨211é¤ç›˜æ³•ï¼š2ä»½è”¬èœ+1ä»½è›‹ç™½+1ä»½ç²—ç²®</li>
                    <li>é¤é—´é›¶é£Ÿé€‰æ‹©åŸå‘³åšæœï¼ˆæ¯æ¬¡â‰¤15gï¼‰</li>
                ` : `
                    <li>ä¿æŒå‡è¡¡é¥®é£Ÿï¼ˆå‚è€ƒè†³é£Ÿå®å¡”ï¼‰</li>
                    <li>æ³¨æ„è¿›é¤é¡ºåºï¼šæ±¤â†’èœâ†’è‚‰â†’ä¸»é£Ÿ</li>
                    <li>ç»†åš¼æ…¢å’½ï¼ˆæ¯é¤â‰¥20åˆ†é’Ÿï¼‰</li>
                `}
            </ul>
        `;
    }
    adviceHTML += `</div></div>`;

    return adviceHTML;
}





// BMIæ£€æµ‹åŠŸèƒ½
function calculateBMI() {
    // è·å–è¾“å…¥å€¼
    const height = parseFloat(document.getElementById('height').value) / 100;
    const weight = parseFloat(document.getElementById('weight').value);
    const age = parseInt(document.getElementById('age').value);
    const occupation = document.getElementById('occupation').value;
    const resultDiv = document.getElementById('bmi-result');

    // éªŒè¯è¾“å…¥
    if (!height || !weight || height <= 0 || weight <= 0 || !age || age < 10 || age > 100) {
        alert("è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å€¼");
        return;
    }

    // è®¡ç®—BMI
    const bmi = weight / (height * height);

    // ç”Ÿæˆå»ºè®®
    const healthAdvice = getHealthAdvice(bmi);
    const personalizedAdvice = generateBMIAdvice(bmi, age, occupation);

    // æ˜¾ç¤ºç»“æœ
    resultDiv.style.display = 'block';
    resultDiv.innerHTML = `
        <h2>æ‚¨çš„BMIå€¼ï¼š<span style="color:${getBMIColorHex(bmi)}">${bmi.toFixed(1)}</span></h2>
        <p>${healthAdvice}</p>
        ${personalizedAdvice}
    `;
    resultDiv.style.backgroundColor = getBMIColor(bmi);
    let bmiScore;
    if (bmi < 18.5) bmiScore = 70;
    else if (bmi < 24) bmiScore = 100;
    else if (bmi < 28) bmiScore = 80;
    else bmiScore = 60;

    saveReport('bmi', bmiScore, {
        height: height,
        weight: weight,
        bmi: bmi
    });
}

function getHealthAdvice(bmi) {
    if (bmi < 18.5) return "æ‚¨çš„ä½“é‡åè½»ï¼Œå»ºè®®å¢åŠ è¥å…»æ‘„å…¥";
    if (bmi < 24) return "æ­å–œï¼æ‚¨çš„ä½“é‡åœ¨å¥åº·èŒƒå›´å†…";
    if (bmi < 28) return "æ‚¨çš„ä½“é‡è¿‡é‡ï¼Œå»ºè®®é€‚å½“è¿åŠ¨";
    return "æ‚¨çš„ä½“é‡å±äºè‚¥èƒ–èŒƒå›´ï¼Œå»ºè®®å’¨è¯¢ä¸“ä¸šåŒ»ç”Ÿ";
}

function getBMIColor(bmi) {
    if (bmi < 18.5) return '#fff9c4'; // æµ…é»„è‰²
    if (bmi < 24) return '#e8f5e9';   // æµ…ç»¿è‰²
    if (bmi < 28) return '#fff3e0';   // æµ…æ©™è‰²
    return '#ffebee';                 // æµ…çº¢è‰²
}

function getBMIColorHex(bmi) {
    if (bmi < 18.5) return '#F57F17'; // é»„è‰²
    if (bmi < 24) return '#2E7D32';   // ç»¿è‰²
    if (bmi < 28) return '#EF6C00';   // æ©™è‰²
    return '#D32F2F';                 // çº¢è‰²
}

function generateBMIAdvice(bmi, age, occupation) {
    let intensity = '';
    let exerciseType = '';
    let dietAdvice = '';

    // é¥®é£Ÿå»ºè®®
    if (bmi < 18.5) {
        dietAdvice = 'å¢åŠ çƒ­é‡æ‘„å…¥ï¼Œé€‰æ‹©é«˜è¥å…»å¯†åº¦é£Ÿç‰©å¦‚åšæœã€å…¨è„‚ä¹³åˆ¶å“';
    } else if (bmi < 24) {
        dietAdvice = 'ä¿æŒå‡è¡¡é¥®é£Ÿï¼Œå¤šåƒè”¬èœæ°´æœå’Œå…¨è°·ç‰©';
    } else {
        dietAdvice = 'å‡å°‘ç²¾åˆ¶ç¢³æ°´ï¼Œå¢åŠ ä¼˜è´¨è›‹ç™½å’Œè†³é£Ÿçº¤ç»´æ‘„å…¥';
    }

    // è¿åŠ¨å¼ºåº¦å»ºè®®
    if (age < 18) {
        intensity = 'ä¸­ç­‰å¼ºåº¦ï¼ˆå¦‚ç¯®çƒã€æ¸¸æ³³ï¼‰æ¯å‘¨5æ¬¡ï¼Œæ¯æ¬¡40åˆ†é’Ÿ';
    } else if (age < 45) {
        intensity = occupation === 'sedentary'
            ? 'é«˜å¼ºåº¦é—´æ­‡è®­ç»ƒï¼ˆHIITï¼‰æ¯å‘¨3æ¬¡+æ—¥å¸¸æ­¥è¡Œ10000æ­¥'
            : 'ä¸­ç­‰å¼ºåº¦æœ‰æ°§è¿åŠ¨ï¼ˆå¦‚æ…¢è·‘ï¼‰æ¯å‘¨5æ¬¡';
    } else {
        intensity = 'ä½å¼ºåº¦è¿åŠ¨ï¼ˆå¦‚å¿«èµ°ã€å¤ªææ‹³ï¼‰æ¯å‘¨5æ¬¡ï¼Œæ¯æ¬¡30åˆ†é’Ÿ';
    }

    // è¿åŠ¨ç±»å‹å»ºè®®
    switch(occupation) {
        case 'sedentary':
            exerciseType = 'é¢ˆè‚©æ”¾æ¾æ“+æ ¸å¿ƒè‚Œç¾¤è®­ç»ƒ';
            break;
        case 'physical':
            exerciseType = 'æŸ”éŸ§æ€§è®­ç»ƒ+ä½å†²å‡»æœ‰æ°§è¿åŠ¨';
            break;
        default:
            exerciseType = 'ç»¼åˆä½“èƒ½è®­ç»ƒ';
    }

    return `
        <div class="advice-section">
            <div class="exercise-advice">
                <h3>è¿åŠ¨æ–¹æ¡ˆï¼š</h3>
                <p>${intensity}</p>
                <h3>æ¨èè¿åŠ¨ï¼š</h3>
                <p>${exerciseType}</p>
            </div>
            <div class="diet-advice">
                <h3>é¥®é£Ÿå»ºè®®ï¼š</h3>
                <p>${dietAdvice}</p>
            </div>
        </div>
    `;
}








// // å¿ƒç†å¥åº·è¯„ä¼°åŠŸèƒ½
function assessMentalHealth() {
    const form = document.getElementById('mentalForm');
    const resultDiv = document.getElementById('mentalResult');
    const emergencyDiv = document.getElementById('emergencyContact');

    // è®¡ç®—DASS-21å¾—åˆ†ï¼ˆç®€åŒ–ç‰ˆï¼‰
    const depressionScore =
        parseInt(form.elements['depression1'].value) +
        parseInt(form.elements['depression2'].value) +
        parseInt(form.elements['depression3'].value);

    const anxietyScore =
        parseInt(form.elements['anxiety1'].value) +
        parseInt(form.elements['anxiety2'].value) +
        parseInt(form.elements['anxiety3'].value);

    const stressScore =
        parseInt(form.elements['stress1'].value) +
        parseInt(form.elements['stress2'].value) +
        parseInt(form.elements['stress3'].value);

    // è‡ªæ€é£é™©è¯„ä¼°
    const suicideRisk = parseInt(form.elements['suicideRisk'].value);

    // è¯„ä¼°ç­‰çº§
    const depressionLevel = getDepressionLevel(depressionScore * 2); // è½¬æ¢ä¸º21åˆ†åˆ¶
    const anxietyLevel = getAnxietyLevel(anxietyScore * 2);
    const stressLevel = getStressLevel(stressScore * 2);

    // ç´§æ€¥æƒ…å†µå¤„ç†
    if (suicideRisk >= 2 || depressionLevel.severity === "ä¸¥é‡") {
        emergencyDiv.style.display = 'block';
    } else {
        emergencyDiv.style.display = 'none';
    }

    // ç”Ÿæˆç»“æœæŠ¥å‘Š
    const resultHTML = `
        <h2>æ‚¨çš„å¿ƒç†å¥åº·è¯„ä¼°ç»“æœ</h2>

        ${suicideRisk >= 1 ? `
            <div class="warning">
                <h3>âš ï¸ é‡è¦æç¤ºï¼š</h3>
                <p>æ‚¨çš„è¯„ä¼°æ˜¾ç¤º${suicideRisk >= 2 ? 'è¾ƒé«˜' : 'æ½œåœ¨'}çš„è‡ªä¼¤é£é™©ï¼Œè¯·ç«‹å³è”ç³»ä¸“ä¸šäººå‘˜</p>
            </div>
        ` : ''}

        <div class="mental-health-scale">
            <h3>æŠ‘éƒæƒ…ç»ª: ${depressionLevel.severity}</h3>
            <p>å¾—åˆ†: ${depressionScore * 2}/21 (${depressionLevel.description})</p>
            <div class="scale-meter">
                <div class="scale-meter-fill depression-fill" style="width: ${depressionScore * 9.5}%"></div>
            </div>
        </div>

        <div class="mental-health-scale">
            <h3>ç„¦è™‘ç—‡çŠ¶: ${anxietyLevel.severity}</h3>
            <p>å¾—åˆ†: ${anxietyScore * 2}/21 (${anxietyLevel.description})</p>
            <div class="scale-meter">
                <div class="scale-meter-fill anxiety-fill" style="width: ${anxietyScore * 9.5}%"></div>
            </div>
        </div>

        <div class="mental-health-scale">
            <h3>å‹åŠ›ååº”: ${stressLevel.severity}</h3>
            <p>å¾—åˆ†: ${stressScore * 2}/21 (${stressLevel.description})</p>
            <div class="scale-meter">
                <div class="scale-meter-fill stress-fill" style="width: ${stressScore * 9.5}%"></div>
            </div>
        </div>

        <div class="coping-card">
            <h4>ğŸ’¡ æ ¹æ®æ‚¨çš„è¯„ä¼°ç»“æœå»ºè®®ï¼š</h4>
            <ul>
                ${generateMentalHealthAdvice(depressionScore, anxietyScore, stressScore, suicideRisk)}
            </ul>
        </div>

        <div class="coping-card">
            <h4>ğŸ§˜ å¿ƒç†è‡ªåŠ©èµ„æºï¼š</h4>
            <ul>
                <li><strong>æ”¾æ¾æŠ€å·§ï¼š</strong>å°è¯•4-7-8å‘¼å¸æ³•ï¼ˆå¸æ°”4ç§’ï¼Œå±æ¯7ç§’ï¼Œå‘¼æ°”8ç§’ï¼‰</li>
                <li><strong>æƒ…ç»ªæ—¥è®°ï¼š</strong>æ¯å¤©è®°å½•3ä»¶è®©æ‚¨æ„Ÿæ©çš„å°äº‹</li>
                <li><strong>æ­£å¿µç»ƒä¹ ï¼š</strong>ä½¿ç”¨å†¥æƒ³APPå¦‚"æ½®æ±"æˆ–"Headspace"</li>
                <li><strong>èº«ä½“æ´»åŠ¨ï¼š</strong>æ¯å¤©30åˆ†é’Ÿæ­¥è¡Œå¯æ˜¾è‘—æ”¹å–„æƒ…ç»ª</li>
            </ul>
        </div>

        <div class="reference">
            <p>æ³¨ï¼šæœ¬è¯„ä¼°åŸºäºDASS-21é‡è¡¨ç®€åŒ–ç‰ˆï¼Œç»“æœä»…ä¾›å‚è€ƒï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šè¯Šæ–­ã€‚</p>
        </div>
    `;

    resultDiv.innerHTML = resultHTML;
    resultDiv.style.display = 'block';
 const avgMentalScore = (depressionScore + anxietyScore + stressScore) / 3;
    const mentalScore = 100 - (avgMentalScore * 4.76); // è½¬æ¢ä¸ºç™¾åˆ†åˆ¶

    saveReport('mental', mentalScore, {
        depression: depressionScore,
        anxiety: anxietyScore,
        stress: stressScore
    });

    resultDiv.scrollIntoView({ behavior: 'smooth' });
}

// DASS-21è¯„ä¼°æ ‡å‡†
function getDepressionLevel(score) {
    if (score <= 4) return { severity: "æ­£å¸¸", description: "æƒ…ç»ªçŠ¶æ€è‰¯å¥½" };
    if (score <= 6) return { severity: "è½»åº¦", description: "å¶å°”æƒ…ç»ªä½è½" };
    if (score <= 10) return { severity: "ä¸­åº¦", description: "æ˜æ˜¾æƒ…ç»ªå›°æ‰°" };
    if (score <= 13) return { severity: "é‡åº¦", description: "ä¸¥é‡æŠ‘éƒç—‡çŠ¶" };
    return { severity: "æé‡", description: "æ€¥éœ€ä¸“ä¸šå¸®åŠ©" };
}

function getAnxietyLevel(score) {
    if (score <= 3) return { severity: "æ­£å¸¸", description: "ç„¦è™‘æ°´å¹³æ­£å¸¸" };
    if (score <= 5) return { severity: "è½»åº¦", description: "å¶æœ‰ç„¦è™‘" };
    if (score <= 7) return { severity: "ä¸­åº¦", description: "æ˜æ˜¾ç„¦è™‘" };
    if (score <= 9) return { severity: "é‡åº¦", description: "ä¸¥é‡ç„¦è™‘" };
    return { severity: "æé‡", description: "æƒŠæå‘ä½œå¯èƒ½" };
}

function getStressLevel(score) {
    if (score <= 7) return { severity: "æ­£å¸¸", description: "å‹åŠ›åº”å¯¹è‰¯å¥½" };
    if (score <= 9) return { severity: "è½»åº¦", description: "å¶æœ‰å‹åŠ›" };
    if (score <= 12) return { severity: "ä¸­åº¦", description: "æŒç»­å‹åŠ›" };
    if (score <= 16) return { severity: "é‡åº¦", description: "é«˜å‹çŠ¶æ€" };
    return { severity: "æé‡", description: "èº«å¿ƒä¿±ç–²" };
}

// ç”Ÿæˆä¸ªæ€§åŒ–å»ºè®®
function generateMentalHealthAdvice(depression, anxiety, stress, suicideRisk) {
    let advice = '';

    // è‡ªæ€é£é™©è¯„ä¼°
    if (suicideRisk >= 2) {
        advice += `
            <li class="warning">âš ï¸ <strong>ç«‹å³è¡ŒåŠ¨ï¼š</strong>æ‚¨æŠ¥å‘Šæœ‰è‡ªä¼¤æƒ³æ³•ï¼Œè¯·ç«‹å³è”ç³»å¿ƒç†æ´åŠ©çƒ­çº¿æˆ–ä¿¡ä»»çš„äºº</li>
            <li>ç§»é™¤å¯èƒ½ç”¨äºè‡ªä¼¤çš„ç‰©å“</li>
            <li>ä¸è¦ç‹¬è‡ªä¸€äººï¼Œç¡®ä¿æœ‰äººé™ªä¼´</li>
        `;
    } else if (suicideRisk === 1) {
        advice += `
            <li>æ‚¨å¶å°”æœ‰æ¶ˆææƒ³æ³•ï¼Œå»ºè®®ä¸å¿ƒç†å’¨è¯¢å¸ˆè°ˆè°ˆè¿™äº›æ„Ÿå—</li>
            <li>åˆ¶å®šå®‰å…¨è®¡åˆ’ï¼šåˆ—å‡ºå¯ä»¥è”ç³»çš„æ”¯æŒäººå‘˜</li>
        `;
    }

    // æŠ‘éƒå»ºè®®
    if (depression >= 6) {
        advice += `
            <li><strong>æŠ‘éƒæƒ…ç»ªï¼š</strong>å»ºè®®é¢„çº¦ç²¾ç¥ç§‘åŒ»ç”Ÿæˆ–å¿ƒç†å’¨è¯¢å¸ˆ</li>
            <li>ä¿æŒè§„å¾‹çš„ä½œæ¯æ—¶é—´ï¼Œå°¤å…¶å›ºå®šèµ·åºŠæ—¶é—´</li>
            <li>æ¯å¤©è¿›è¡Œå°‘é‡è¿åŠ¨ï¼Œå³ä½¿åªæ˜¯çŸ­é€”æ•£æ­¥</li>
        `;
    } else if (depression >= 3) {
        advice += `
            <li><strong>æƒ…ç»ªæ³¢åŠ¨ï¼š</strong>å°è¯•è®°å½•æƒ…ç»ªå˜åŒ–è§„å¾‹</li>
            <li>å¢åŠ ç¤¾äº¤æ´»åŠ¨ï¼Œæ¯å‘¨è‡³å°‘è§1ä½æœ‹å‹</li>
        `;
    }

    // ç„¦è™‘å»ºè®®
    if (anxiety >= 6) {
        advice += `
            <li><strong>ç„¦è™‘ç®¡ç†ï¼š</strong>ç»ƒä¹ è…¹å¼å‘¼å¸ï¼Œæ¯å¤©3æ¬¡</li>
            <li>é™åˆ¶å’–å•¡å› æ‘„å…¥ï¼Œå°¤å…¶æ˜¯ä¸‹åˆ</li>
            <li>å°è¯•"5-4-3-2-1" groundingæŠ€å·§ï¼šè¯´å‡º5ä¸ªçœ‹åˆ°çš„ã€4ä¸ªè§¦æ‘¸åˆ°çš„ã€3ä¸ªå¬åˆ°çš„ã€2ä¸ªé—»åˆ°çš„å’Œ1ä¸ªå°åˆ°çš„ä¸œè¥¿</li>
        `;
    } else if (anxiety >= 3) {
        advice += `
            <li><strong>ç„¦è™‘ç¼“è§£ï¼š</strong>æ¯å¤©å®‰æ’"æ‹…å¿§æ—¶é—´"(15åˆ†é’Ÿ)ï¼Œå…¶ä»–æ—¶é—´æ¨è¿Ÿæ‹…å¿§</li>
            <li>ç»ƒä¹ æ¸è¿›å¼è‚Œè‚‰æ”¾æ¾</li>
        `;
    }

    // å‹åŠ›å»ºè®®
    if (stress >= 6) {
        advice += `
            <li><strong>å‹åŠ›è°ƒèŠ‚ï¼š</strong>å­¦ä¹ æ—¶é—´ç®¡ç†æŠ€å·§</li>
            <li>æ¯å¤©ä¿è¯7-8å°æ—¶ç¡çœ </li>
            <li>å°è¯•ç‘œä¼½æˆ–å¤ªæç­‰èˆ’ç¼“è¿åŠ¨</li>
        `;
    } else if (stress >= 3) {
        advice += `
            <li><strong>å‹åŠ›ç¼“è§£ï¼š</strong>æ¯å¤©10åˆ†é’Ÿæ­£å¿µå†¥æƒ³</li>
            <li>å»ºç«‹å·¥ä½œ-ä¼‘æ¯å‘¨æœŸ(å¦‚50åˆ†é’Ÿå·¥ä½œ+10åˆ†é’Ÿä¼‘æ¯)</li>
        `;
    }

    // é€šç”¨å»ºè®®
    if (advice === '') {
        advice = `
            <li>æ‚¨çš„å¿ƒç†å¥åº·çŠ¶æ€è‰¯å¥½ï¼Œç»§ç»­ä¿æŒ</li>
            <li>é¢„é˜²æ€§æªæ–½ï¼šä¿æŒç¤¾äº¤è”ç³»å’Œè§„å¾‹è¿åŠ¨</li>
            <li>å­¦ä¹ æƒ…ç»ªç®¡ç†æŠ€å·§ä»¥å¤‡ä¸æ—¶ä¹‹éœ€</li>
        `;
    } else {
        advice += `
            <li><strong>ä¸“ä¸šå¸®åŠ©ï¼š</strong>å¦‚æœç—‡çŠ¶æŒç»­2å‘¨ä»¥ä¸Šï¼Œå»ºè®®å¯»æ±‚ä¸“ä¸šè¯„ä¼°</li>
            <li><strong>ç´§æ€¥æƒ…å†µï¼š</strong>å½“æ„Ÿåˆ°å¤±æ§æ—¶ï¼Œç«‹å³è”ç³»å±æœºå¹²é¢„çƒ­çº¿</li>
        `;
    }

    return advice;
}






// PSQIç¡çœ è´¨é‡è¯„ä¼°
function calculatePSQI() {
    const form = document.getElementById('sleepForm');
    const resultDiv = document.getElementById('sleepResult');

    // ç»„æˆéƒ¨åˆ†1ï¼šä¸»è§‚ç¡çœ è´¨é‡
    const component1 = parseInt(form.elements['q1'].value);

    // ç»„æˆéƒ¨åˆ†2ï¼šç¡çœ æ½œä¼æœŸ
    const component2 = Math.min(parseInt(form.elements['q2'].value) + parseInt(form.elements['q3'].value), 3);

    // ç»„æˆéƒ¨åˆ†3ï¼šç¡çœ æŒç»­æ—¶é—´
    const component3 = parseInt(form.elements['q4'].value);

    // ç»„æˆéƒ¨åˆ†4ï¼šç¡çœ æ•ˆç‡ï¼ˆè®¡ç®—ï¼‰
    let component4 = 0;
    const bedtime = form.elements['bedtime'].value;
    const waketime = form.elements['waketime'].value;

    if (bedtime && waketime) {
        const bedHour = parseInt(bedtime.split(':')[0]);
        const bedMin = parseInt(bedtime.split(':')[1]);
        const wakeHour = parseInt(waketime.split(':')[0]);
        const wakeMin = parseInt(waketime.split(':')[1]);

        let bedTotal = bedHour * 60 + bedMin;
        let wakeTotal = wakeHour * 60 + wakeMin;

        // å¤„ç†è·¨åˆå¤œæƒ…å†µ
        if (wakeTotal < bedTotal) wakeTotal += 24 * 60;

        const timeInBed = wakeTotal - bedTotal;
        const sleepDuration = component3 === 0 ? 7.5 * 60 :
                             component3 === 1 ? 6.5 * 60 :
                             component3 === 2 ? 5.5 * 60 : 4.5 * 60;

        const efficiency = (sleepDuration / timeInBed) * 100;

        if (efficiency > 85) component4 = 0;
        else if (efficiency > 75) component4 = 1;
        else if (efficiency > 65) component4 = 2;
        else component4 = 3;
    }

    // ç»„æˆéƒ¨åˆ†5ï¼šç¡çœ éšœç¢
    const disturbanceItems = [
        parseInt(form.elements['q5a'].value),
        parseInt(form.elements['q5b'].value),
        parseInt(form.elements['q5c'].value),
        parseInt(form.elements['q5d'].value),
        parseInt(form.elements['q5e'].value),
        parseInt(form.elements['q5f'].value),
        parseInt(form.elements['q5g'].value),
        parseInt(form.elements['q5h'].value)
    ];
    const disturbanceSum = disturbanceItems.reduce((a, b) => a + b, 0);
    const component5 = disturbanceSum > 0 ? (disturbanceSum > 9 ? 3 : (disturbanceSum > 4 ? 2 : 1)) : 0;

    // ç»„æˆéƒ¨åˆ†6ï¼šå‚¬çœ è¯ç‰©ä½¿ç”¨
    const component6 = parseInt(form.elements['q6'].value);

    // ç»„æˆéƒ¨åˆ†7ï¼šæ—¥é—´åŠŸèƒ½éšœç¢
    const component7 = Math.min(parseInt(form.elements['q7a'].value) + parseInt(form.elements['q7b'].value), 3);

    // è®¡ç®—æ€»åˆ†
    const totalScore = component1 + component2 + component3 + component4 + component5 + component6 + component7;

    // ç”Ÿæˆç»“æœæŠ¥å‘Š
    let result = `
        <h2>æ‚¨çš„PSQIè¯„åˆ†ï¼š${totalScore}åˆ†</h2>
        <p>${getSleepQualityText(totalScore)}</p>

        <div class="sleep-advice">
            <h3>å„ç»„æˆéƒ¨åˆ†è¯„åˆ†ï¼š</h3>
            <ul>
                <li>ä¸»è§‚ç¡çœ è´¨é‡ï¼š${component1}åˆ†</li>
                <li>å…¥ç¡æ—¶é—´ï¼š${component2}åˆ†</li>
                <li>ç¡çœ æ—¶é—´ï¼š${component3}åˆ†</li>
                <li>ç¡çœ æ•ˆç‡ï¼š${component4}åˆ†</li>
                <li>ç¡çœ éšœç¢ï¼š${component5}åˆ†</li>
                <li>å‚¬çœ è¯ç‰©ï¼š${component6}åˆ†</li>
                <li>æ—¥é—´åŠŸèƒ½éšœç¢ï¼š${component7}åˆ†</li>
            </ul>
        </div>

        ${generateSleepAdvice(totalScore, component1, component2, component3, component4, component5, component6, component7)}
    `;

    resultDiv.innerHTML = result;
    resultDiv.style.display = 'block';

    // æ»šåŠ¨åˆ°ç»“æœ
    resultDiv.scrollIntoView({ behavior: 'smooth' });
}

function getSleepQualityText(score) {
    if (score <= 5) return 'ç¡çœ è´¨é‡è‰¯å¥½';
    if (score <= 10) return 'ç¡çœ è´¨é‡ä¸€èˆ¬ï¼Œæœ‰è½»åº¦é—®é¢˜';
    return 'ç¡çœ è´¨é‡å·®ï¼Œå»ºè®®å°±åŒ»å’¨è¯¢';
}

function generateSleepAdvice(totalScore, c1, c2, c3, c4, c5, c6, c7) {
    let advice = '<div class="sleep-advice"><h3>ä¸ªæ€§åŒ–å»ºè®®ï¼š</h3><ul>';

    // æ€»ä½“å»ºè®®
    if (totalScore > 10) {
        advice += '<li class="warning">âš ï¸ æ‚¨çš„ç¡çœ é—®é¢˜è¾ƒä¸¥é‡ï¼Œå»ºè®®å°½å¿«å’¨è¯¢ä¸“ä¸šåŒ»ç”Ÿ</li>';
    }

    // å„ç»„æˆéƒ¨åˆ†å»ºè®®
    if (c1 >= 2) {
        advice += '<li>æ”¹å–„ç¡çœ ç¯å¢ƒï¼šä¿æŒå§å®¤å®‰é™ã€é»‘æš—å’Œé€‚å®œæ¸©åº¦(18-22â„ƒ)</li>';
    }

    if (c2 >= 2) {
        advice += '<li>å»ºç«‹è§„å¾‹çš„ç¡å‰ä»ªå¼ï¼šç¡å‰1å°æ—¶é¿å…å±å¹•è“å…‰ï¼Œå°è¯•é˜…è¯»æˆ–å†¥æƒ³</li>';
    }

    if (c3 >= 2) {
        advice += '<li>å¢åŠ ç¡çœ æ—¶é—´ï¼šå°è¯•æå‰30åˆ†é’Ÿä¸ŠåºŠï¼Œé€æ­¥è°ƒæ•´ä½œæ¯</li>';
    }

    if (c4 >= 2) {
        advice += '<li>æé«˜ç¡çœ æ•ˆç‡ï¼šå‡å°‘åºŠä¸Šéç¡çœ æ´»åŠ¨(å¦‚ç©æ‰‹æœº)ï¼Œåªåœ¨å›°å€¦æ—¶ä¸ŠåºŠ</li>';
    }

    if (c5 >= 2) {
        advice += '<li>å‡å°‘å¤œé—´å¹²æ‰°ï¼šç¡å‰2å°æ—¶é™åˆ¶æ¶²ä½“æ‘„å…¥ï¼Œä½¿ç”¨è€³å¡æˆ–çœ¼ç½©</li>';
    }

    if (c6 >= 1) {
        advice += '<li>è°¨æ…ä½¿ç”¨å®‰çœ è¯ï¼šé•¿æœŸä½¿ç”¨å¯èƒ½å¯¼è‡´ä¾èµ–ï¼Œå»ºè®®å’¨è¯¢åŒ»ç”Ÿ</li>';
    }

    if (c7 >= 2) {
        advice += '<li>æ”¹å–„æ—¥é—´ç²¾åŠ›ï¼šåˆä¼‘ä¸è¶…è¿‡30åˆ†é’Ÿï¼Œä¿æŒé€‚åº¦è¿åŠ¨</li>';
    }

    // é€šç”¨å»ºè®®
    advice += `
        <li>ä¿æŒè§„å¾‹ä½œæ¯ï¼šæ¯å¤©åŒä¸€æ—¶é—´èµ·åºŠ(åŒ…æ‹¬å‘¨æœ«)</li>
        <li>é€‚åº¦è¿åŠ¨ï¼šæ¯å¤©30åˆ†é’Ÿæœ‰æ°§è¿åŠ¨ï¼Œä½†é¿å…ç¡å‰3å°æ—¶å‰§çƒˆè¿åŠ¨</li>
        <li>æ§åˆ¶å’–å•¡å› ï¼šä¸‹åˆ2ç‚¹åé¿å…å’–å•¡ã€èŒ¶ç­‰å«å’–å•¡å› é¥®æ–™</li>
    `;

    advice += '</ul></div>';
    return advice;
}







// è¿åŠ¨æ°´å¹³è¯„ä¼°åŠŸèƒ½
function assessExerciseLevel() {
    const form = document.getElementById('exerciseForm');
    const resultDiv = document.getElementById('exerciseResult');

    // è·å–è¾“å…¥å€¼
    const vigorousDays = parseInt(form.elements['vigorousDays'].value);
    const vigorousMins = parseInt(form.elements['vigorousMinutes'].value) || 0;
    const moderateDays = parseInt(form.elements['moderateDays'].value);
    const moderateMins = parseInt(form.elements['moderateMinutes'].value) || 0;
    const walkingDays = parseInt(form.elements['walkingDays'].value);
    const walkingMins = parseInt(form.elements['walkingMinutes'].value) || 0;
    const sittingHours = parseFloat(form.elements['sittingHours'].value) || 0;
    const age = parseInt(form.elements['age'].value);
    const gender = form.elements['gender'].value;
    const healthCondition = form.elements['healthCondition'].value;

    // éªŒè¯è¾“å…¥
    if ((vigorousDays > 0 && !vigorousMins) ||
        (moderateDays > 0 && !moderateMins) ||
        (walkingDays > 0 && !walkingMins) ||
        !age) {
        alert("è¯·å¡«å†™å®Œæ•´çš„è¿åŠ¨ä¿¡æ¯");
        return;
    }

    // è®¡ç®—METåˆ†é’Ÿ/å‘¨ï¼ˆå›½é™…æ ‡å‡†ï¼‰
    const vigorousMET = vigorousDays * vigorousMins * 8.0;
    const moderateMET = moderateDays * moderateMins * 4.0;
    const walkingMET = walkingDays * walkingMins * 3.3;
    const totalMET = vigorousMET + moderateMET + walkingMET;

    // è¯„ä¼°è¿åŠ¨æ°´å¹³
    let activityLevel = '';
    let intensityPercentage = 0;

    if (totalMET >= 3000) {
        activityLevel = 'é«˜å¼ºåº¦æ´»è·ƒ';
        intensityPercentage = 100;
    } else if (totalMET >= 1500) {
        activityLevel = 'ä¸­ç­‰å¼ºåº¦æ´»è·ƒ';
        intensityPercentage = 70;
    } else if (totalMET >= 600) {
        activityLevel = 'åŸºæœ¬æ´»è·ƒ';
        intensityPercentage = 40;
    } else {
        activityLevel = 'ç¼ºä¹è¿åŠ¨';
        intensityPercentage = 10;
    }

    // ä¹…åè¯„ä¼°
    const sittingLevel = sittingHours >= 8 ? 'è¿‡é«˜' :
                       sittingHours >= 4 ? 'ä¸­ç­‰' : 'ç†æƒ³';

    // ç”Ÿæˆä¸ªæ€§åŒ–å»ºè®®
    const healthWarning = healthCondition !== 'none' ?
        `<div class="warning">
            <p>âš ï¸ æ‚¨æŠ¥å‘Šæœ‰${getHealthConditionText(healthCondition)}ï¼Œå¼€å§‹æ–°è¿åŠ¨è®¡åˆ’å‰è¯·å’¨è¯¢åŒ»ç”Ÿ</p>
        </div>` : '';

    const resultHTML = `
        <h2>æ‚¨çš„è¿åŠ¨è¯„ä¼°ç»“æœ</h2>
        ${healthWarning}

        <div class="fitness-card">
            <h4>ğŸ† æ€»ä½“è¿åŠ¨æ°´å¹³: ${activityLevel}</h4>
            <p>æ€»è¿åŠ¨é‡: ${Math.round(totalMET)} MET-åˆ†é’Ÿ/å‘¨</p>
            <div class="intensity-meter">
                <div class="intensity-meter-fill" style="width: ${intensityPercentage}%"></div>
            </div>
            <p>${getActivityLevelDescription(activityLevel, totalMET)}</p>
        </div>

        <div class="fitness-card">
            <h4>ğŸ“Š è¿åŠ¨æ„æˆåˆ†æ</h4>
            <ul>
                <li>é«˜å¼ºåº¦è¿åŠ¨: ${vigorousDays}å¤©/å‘¨ Ã— ${vigorousMins}åˆ†é’Ÿ/å¤©</li>
                <li>ä¸­ç­‰å¼ºåº¦è¿åŠ¨: ${moderateDays}å¤©/å‘¨ Ã— ${moderateMins}åˆ†é’Ÿ/å¤©</li>
                <li>æ­¥è¡Œ: ${walkingDays}å¤©/å‘¨ Ã— ${walkingMins}åˆ†é’Ÿ/å¤©</li>
                <li>ä¹…åæ—¶é—´: ${sittingHours}å°æ—¶/å¤© (${sittingLevel})</li>
            </ul>
        </div>

        <div class="fitness-card">
            <h4>ğŸ“ ä¸ªæ€§åŒ–è¿åŠ¨å»ºè®®</h4>
            ${generateExerciseAdvice(activityLevel, totalMET, vigorousDays, moderateDays, walkingDays, sittingHours, age, gender, healthCondition)}
        </div>

        <div class="reference">
            <h4>å‚è€ƒæ ‡å‡†ï¼ˆWHOå»ºè®®ï¼‰</h4>
            <ul>
                <li>18-64å²æˆå¹´äººæ¯å‘¨è‡³å°‘ï¼š</li>
                <li>150-300åˆ†é’Ÿä¸­ç­‰å¼ºåº¦ <strong>æˆ–</strong> 75-150åˆ†é’Ÿé«˜å¼ºåº¦æœ‰æ°§è¿åŠ¨</li>
                <li>2å¤©ä»¥ä¸Šè‚Œè‚‰å¼ºåŒ–æ´»åŠ¨</li>
                <li>é™åˆ¶ä¹…åæ—¶é—´ï¼Œæ¯å°æ—¶èµ·æ¥æ´»åŠ¨</li>
            </ul>
        </div>
    `;

    resultDiv.innerHTML = resultHTML;
    resultDiv.style.display = 'block';
    resultDiv.scrollIntoView({ behavior: 'smooth' });
    const exerciseScore = Math.min(100, totalMET / 30); // 3000 METå¯¹åº”100åˆ†
    saveReport('exercise', exerciseScore, {
        totalMET: totalMET,
        activityLevel: activityLevel
    });
}

// è¾…åŠ©å‡½æ•°
function getHealthConditionText(condition) {
    const map = {
        'cardiovascular': 'å¿ƒè¡€ç®¡ç–¾ç—…',
        'musculoskeletal': 'è‚Œè‚‰éª¨éª¼é—®é¢˜',
        'metabolic': 'ä»£è°¢æ€§ç–¾ç—…',
        'other': 'å¥åº·é—®é¢˜'
    };
    return map[condition] || 'å¥åº·é—®é¢˜';
}

function getActivityLevelDescription(level, met) {
    const descriptions = {
        'é«˜å¼ºåº¦æ´»è·ƒ': `ä¼˜ç§€ï¼æ‚¨çš„è¿åŠ¨é‡(${Math.round(met)} MET)è¿œè¶…å¥åº·æ ‡å‡†ï¼Œä¿æŒè§„å¾‹è¿åŠ¨çš„åŒæ—¶æ³¨æ„æ¢å¤`,
        'ä¸­ç­‰å¼ºåº¦æ´»è·ƒ': `è‰¯å¥½ï¼æ‚¨çš„è¿åŠ¨é‡(${Math.round(met)} MET)è¾¾åˆ°å¥åº·æ ‡å‡†ï¼Œå¯è€ƒè™‘å¢åŠ ä¸€äº›é«˜å¼ºåº¦è¿åŠ¨`,
        'åŸºæœ¬æ´»è·ƒ': `åŠæ ¼ã€‚æ‚¨çš„è¿åŠ¨é‡(${Math.round(met)} MET)æ¥è¿‘æœ€ä½æ ‡å‡†ï¼Œå»ºè®®é€æ­¥å¢åŠ è¿åŠ¨æ—¶é—´å’Œå¼ºåº¦`,
        'ç¼ºä¹è¿åŠ¨': `æ‚¨çš„è¿åŠ¨é‡(${Math.round(met)} MET)ä¸è¶³ï¼Œé•¿æœŸå¯èƒ½å½±å“å¥åº·ï¼Œå»ºè®®ä»æ¯å¤©10åˆ†é’Ÿæ­¥è¡Œå¼€å§‹`
    };
    return descriptions[level];
}

function generateExerciseAdvice(level, met, vigorousDays, moderateDays, walkingDays, sittingHours, age, gender, health) {
    let advice = '<ul>';

    // æ ¹æ®æ´»åŠ¨æ°´å¹³å»ºè®®
    if (level === 'ç¼ºä¹è¿åŠ¨') {
        advice += `
            <li>ä»ä½å¼ºåº¦å¼€å§‹ï¼šæ¯å¤©10-15åˆ†é’Ÿæ­¥è¡Œï¼Œæ¯å‘¨5å¤©</li>
            <li>è®¾ç½®å°ç›®æ ‡ï¼šå¦‚æ¯å¤©å¤šèµ°500æ­¥ï¼Œæ¯å‘¨å¢åŠ 10%è¿åŠ¨æ—¶é—´</li>
            <li>èå…¥ç”Ÿæ´»ï¼šèµ°æ¥¼æ¢¯ä»£æ›¿ç”µæ¢¯ï¼Œç«™ç«‹åŠå…¬ç­‰</li>
        `;
    } else if (level === 'åŸºæœ¬æ´»è·ƒ') {
        advice += `
            <li>å¢åŠ è¿åŠ¨é¢‘ç‡ï¼šç›®æ ‡æ¯å‘¨5å¤©ä»¥ä¸Šä¸­ç­‰å¼ºåº¦è¿åŠ¨</li>
            <li>å°è¯•æ–°å½¢å¼ï¼šæ¸¸æ³³ã€éª‘è¡Œã€èˆè¹ˆç­‰æœ‰è¶£çš„æ´»åŠ¨</li>
            <li>åŠ å…¥åŠ›é‡è®­ç»ƒï¼šæ¯å‘¨2æ¬¡å…¨èº«è‚Œè‚‰é”»ç‚¼</li>
        `;
    } else {
        advice += `
            <li>ä¿æŒå¤šæ ·æ€§ï¼šç»“åˆæœ‰æ°§ã€åŠ›é‡å’ŒæŸ”éŸ§æ€§è®­ç»ƒ</li>
            <li>å…³æ³¨æ¢å¤ï¼šé«˜å¼ºåº¦è®­ç»ƒåä¿è¯48å°æ—¶æ¢å¤æœŸ</li>
            <li>æŒ‘æˆ˜è‡ªæˆ‘ï¼šå°è¯•é—´æ­‡è®­ç»ƒæå‡å¿ƒè‚ºåŠŸèƒ½</li>
        `;
    }

    // ä¹…åå»ºè®®
    if (sittingHours >= 6) {
        advice += `
            <li>å‡å°‘ä¹…åï¼šæ¯30åˆ†é’Ÿç«™ç«‹æ´»åŠ¨1-2åˆ†é’Ÿ</li>
            <li>ä½¿ç”¨ç«™ç«‹å¼åŠå…¬æ¡Œæˆ–å®šæ—¶æé†’</li>
            <li>çœ‹ç”µè§†æ—¶åšç®€å•æ‹‰ä¼¸æˆ–åŸåœ°è¸æ­¥</li>
        `;
    }

    // å¹´é¾„ç›¸å…³å»ºè®®
    if (age > 50) {
        advice += `
            <li>æ³¨é‡å¹³è¡¡è®­ç»ƒï¼šé¢„é˜²è·Œå€’ï¼Œå¦‚å¤ªææ‹³ã€å•è…¿ç«™ç«‹</li>
            <li>ä¿æŠ¤å…³èŠ‚ï¼šé€‰æ‹©ä½å†²å‡»è¿åŠ¨å¦‚æ¸¸æ³³ã€æ¤­åœ†æœº</li>
            <li>åŠ›é‡è®­ç»ƒï¼šä¿æŒè‚Œè‚‰é‡ï¼Œæ¯å‘¨2æ¬¡</li>
        `;
    }

    // æ€§åˆ«ç›¸å…³å»ºè®®
    if (gender === 'female') {
        advice += `
            <li>å…³æ³¨éª¨å¯†åº¦ï¼šç»“åˆè´Ÿé‡è¿åŠ¨å’Œé’™è´¨æ‘„å…¥</li>
            <li>ç›†åº•è‚Œé”»ç‚¼ï¼šå‡¯æ ¼å°”è¿åŠ¨</li>
        `;
    }

    // å¥åº·çŠ¶å†µå»ºè®®
    if (health !== 'none') {
        advice += `
            <li class="warning">æ ¹æ®æ‚¨çš„å¥åº·çŠ¶å†µï¼Œå»ºè®®ï¼š</li>
            <li>å’¨è¯¢åŒ»ç”Ÿååˆ¶å®šä¸ªæ€§åŒ–æ–¹æ¡ˆ</li>
            <li>è¿åŠ¨æ—¶æ³¨æ„ç›‘æµ‹èº«ä½“ååº”</li>
            <li>é¿å…${health === 'cardiovascular' ? 'å‰§çƒˆè¿åŠ¨' : health === 'musculoskeletal' ? 'é«˜å†²å‡»åŠ¨ä½œ' : 'é•¿æ—¶é—´ç©ºè…¹è¿åŠ¨'}</li>
        `;
    }

    // è¿åŠ¨å¤„æ–¹ç¤ºä¾‹
    advice += `
        </ul>
        <div class="exercise-advice">
            <h4>ğŸ… ä¸ºæ‚¨æ¨èçš„è¿åŠ¨è®¡åˆ’ï¼š</h4>
            ${generateExercisePrescription(level, age, health)}
        </div>
    `;

    return advice;
}

function generateExercisePrescription(level, age, health) {
    let prescription = '';

    if (level === 'ç¼ºä¹è¿åŠ¨') {
        prescription = `
            <p><strong>åˆçº§é˜¶æ®µ(1-4å‘¨)ï¼š</strong></p>
            <ul>
                <li>æ¯å¤©æ­¥è¡Œ10-15åˆ†é’Ÿï¼Œæ¯å‘¨5å¤©</li>
                <li>æ¯å‘¨2æ¬¡æ¤…å­ç‘œä¼½æˆ–ä¼¸å±•è¿åŠ¨</li>
                <li>ç›®æ ‡ï¼šæ¯å‘¨ç´¯è®¡150åˆ†é’Ÿè½»åº¦æ´»åŠ¨</li>
            </ul>
        `;
    } else if (level === 'åŸºæœ¬æ´»è·ƒ') {
        prescription = `
            <p><strong>ä¸­çº§é˜¶æ®µ(4-12å‘¨)ï¼š</strong></p>
            <ul>
                <li>å¿«èµ°/æ¸¸æ³³/éª‘è¡Œ30åˆ†é’Ÿï¼Œæ¯å‘¨5å¤©</li>
                <li>æ¯å‘¨2æ¬¡å…¨èº«åŠ›é‡è®­ç»ƒ(è‡ªé‡æˆ–è½»å™¨æ¢°)</li>
                <li>ç›®æ ‡ï¼šæ¯å‘¨150åˆ†é’Ÿä¸­ç­‰å¼ºåº¦è¿åŠ¨</li>
            </ul>
        `;
    } else {
        prescription = `
            <p><strong>é«˜çº§é˜¶æ®µï¼š</strong></p>
            <ul>
                <li>é«˜å¼ºåº¦é—´æ­‡è®­ç»ƒ(HIIT)20åˆ†é’Ÿï¼Œæ¯å‘¨2-3æ¬¡</li>
                <li>ä¸­ç­‰å¼ºåº¦è¿åŠ¨30-45åˆ†é’Ÿï¼Œæ¯å‘¨3-4æ¬¡</li>
                <li>åŠ›é‡è®­ç»ƒ30åˆ†é’Ÿï¼Œæ¯å‘¨2-3æ¬¡</li>
                <li>ç‘œä¼½/æ‹‰ä¼¸ï¼Œæ¯å‘¨2æ¬¡</li>
            </ul>
        `;
    }

    // ç‰¹æ®Šäººç¾¤è°ƒæ•´
    if (age > 65 || health !== 'none') {
        prescription += `
            <p class="warning">âš ï¸ æ ¹æ®æ‚¨çš„å¹´é¾„/å¥åº·çŠ¶å†µï¼Œå»ºè®®ï¼š</p>
            <ul>
                <li>è¿åŠ¨å‰å……åˆ†çƒ­èº«(10-15åˆ†é’Ÿ)</li>
                <li>${age > 65 ? 'æ³¨é‡å¹³è¡¡è®­ç»ƒ' : health === 'cardiovascular' ? 'é¿å…å±æ°”ç”¨åŠ›' : 'é¿å…å…³èŠ‚è¿‡åº¦è´Ÿè·'}</li>
                <li>è¿åŠ¨æ—¶å¿ƒç‡æ§åˆ¶åœ¨(220-å¹´é¾„)Ã—0.6~0.8</li>
            </ul>
        `;
    }

    return prescription;
}



// ===== é¥®é£Ÿå¥åº·è¯„ä¼°åŠŸèƒ½ =====
function assessDiet() {
    const form = document.getElementById('dietForm');
    const resultDiv = document.getElementById('dietResult');

    // è·å–åŸºæœ¬ä¿¡æ¯
    const height = parseFloat(form.elements['height'].value);
    const weight = parseFloat(form.elements['weight'].value);
    const age = parseInt(form.elements['age'].value);
    const gender = form.elements['gender'].value;
    const activity = form.elements['activity'].value;

    // éªŒè¯åŸºæœ¬ä¿¡æ¯
    if (!height || !weight || !age || height <= 0 || weight <= 0 || age <= 0) {
        alert("è¯·è¾“å…¥æœ‰æ•ˆçš„èº«ä½“æ•°æ®");
        return;
    }

    // è®¡ç®—BMI
    const bmi = weight / Math.pow(height/100, 2);
    const bmiCategory = getBMICategory(bmi);

    // è®¡ç®—é¥®é£Ÿå¤šæ ·æ€§å¾—åˆ†(DDS)
    const ddsScore =
        parseInt(form.elements['wholeGrain'].value) +
        parseInt(form.elements['vegetables'].value) +
        parseInt(form.elements['fruits'].value) +
        parseInt(form.elements['dairy'].value) +
        parseInt(form.elements['protein'].value);

    // è·å–é¥®é£Ÿä¹ æƒ¯æ•°æ®
    const mealsPerDay = parseInt(form.elements['mealsPerDay'].value);
    const breakfastItems = Array.from(form.elements['breakfast'])
        .filter(c => c.checked)
        .map(c => c.value);
    const eatOut = parseInt(form.elements['eatOut'].value);
    const snacks = parseInt(form.elements['snacks'].value);
    const water = parseInt(form.elements['water'].value);

    // è®¡ç®—åŸºç¡€ä»£è°¢ç‡(BMR)
    let bmr;
    if (gender === 'male') {
        bmr = 88.362 + (13.397 * weight) + (4.799 * height) - (5.677 * age);
    } else {
        bmr = 447.593 + (9.247 * weight) + (3.098 * height) - (4.330 * age);
    }

    // è®¡ç®—æ¯æ—¥æ€»èƒ½é‡éœ€æ±‚
    let tdee;
    switch(activity) {
        case 'sedentary': tdee = bmr * 1.2; break;
        case 'light': tdee = bmr * 1.375; break;
        case 'moderate': tdee = bmr * 1.55; break;
        case 'active': tdee = bmr * 1.725; break;
        default: tdee = bmr * 1.2;
    }

    // è¯„ä¼°ç»“æœ
    const dietQuality = assessDietQuality(ddsScore, breakfastItems, mealsPerDay, eatOut, snacks, water);

    // ç”Ÿæˆç»“æœæŠ¥å‘Š
    const resultHTML = `
        <h2>æ‚¨çš„é¥®é£Ÿå¥åº·æŠ¥å‘Š</h2>

        <div class="nutrition-card">
            <h4>ğŸ“Š åŸºæœ¬æŒ‡æ ‡</h4>
            <ul>
                <li>èº«é«˜: ${height} cm</li>
                <li>ä½“é‡: ${weight} kg</li>
                <li>BMI: ${bmi.toFixed(1)} (${bmiCategory})</li>
                <li>åŸºç¡€ä»£è°¢ç‡: ${bmr.toFixed(0)} å¤§å¡/å¤©</li>
                <li>æ¯æ—¥èƒ½é‡éœ€æ±‚: ${tdee.toFixed(0)} å¤§å¡/å¤©</li>
            </ul>
        </div>

        <div class="nutrition-card">
            <h4>ğŸ¥— é¥®é£Ÿå¤šæ ·æ€§è¯„åˆ†</h4>
            <div class="nutrition-score">${ddsScore}/15</div>
            <div class="nutrition-meter">
                <div class="nutrition-meter-fill" style="width: ${ddsScore*6.67}%"></div>
            </div>
            <p>${getDDSEvaluation(ddsScore)}</p>
        </div>

        <div class="nutrition-card">
            <h4>ğŸ“ é¥®é£Ÿç»“æ„åˆ†æ</h4>
            ${generateDietAnalysis(breakfastItems, mealsPerDay, eatOut, snacks, water)}
        </div>

        <div class="nutrition-card">
            <h4>ğŸ½ï¸ ä¸ºæ‚¨æ¨èçš„é¥®é£Ÿæ”¹è¿›</h4>
            ${generateDietRecommendations(ddsScore, bmiCategory, breakfastItems, eatOut, snacks, water)}
        </div>

        <div class="nutrition-card">
            <h4>ğŸ“‹ ä¸ªæ€§åŒ–é¥®é£Ÿè®¡åˆ’</h4>
            ${generateMealPlan(bmiCategory, activity, gender, age)}
        </div>

        <div class="reference">
            <p>è¯„ä¼°æ ‡å‡†å‚è€ƒï¼šä¸­å›½å±…æ°‘è†³é£ŸæŒ‡å—(2022)ã€WHOå¥åº·é¥®é£Ÿå»ºè®®</p>
        </div>
    `;

    resultDiv.innerHTML = resultHTML;
    resultDiv.style.display = 'block';
    resultDiv.scrollIntoView({ behavior: 'smooth' });
      const dietScore = (ddsScore * 100) / 15; // è½¬æ¢ä¸ºç™¾åˆ†åˆ¶
    saveReport('diet', dietScore, {
        ddsScore: ddsScore,
        bmi: bmi
    });
}

// ===== è¾…åŠ©å‡½æ•° =====
function getBMICategory(bmi) {
    if (bmi < 18.5) return 'åç˜¦';
    if (bmi < 24) return 'æ­£å¸¸';
    if (bmi < 28) return 'è¶…é‡';
    return 'è‚¥èƒ–';
}

function assessDietQuality(ddsScore, breakfastItems, mealsPerDay, eatOut, snacks, water) {
    let score = 0;

    // é¥®é£Ÿå¤šæ ·æ€§(æ»¡åˆ†50åˆ†)
    score += ddsScore * 3;

    // æ—©é¤è´¨é‡(æ»¡åˆ†15åˆ†)
    if (breakfastItems.includes('protein')) score += 5;
    if (breakfastItems.includes('wholeGrain')) score += 5;
    if (breakfastItems.includes('fruit') || breakfastItems.includes('vegetable')) score += 5;

    // é¥®é£Ÿä¹ æƒ¯(æ»¡åˆ†35åˆ†)
    score += (3 - mealsPerDay) * 5; // 3é¤ä¸ºæ»¡åˆ†
    score += (3 - eatOut) * 5;
    score += (3 - snacks) * 5;
    score += water * 5;

    return {
        total: score,
        percent: Math.min(100, Math.round(score / 100 * 100))
    };
}

function getDDSEvaluation(score) {
    if (score >= 12) return 'ä¼˜ç§€ï¼æ‚¨çš„é¥®é£Ÿç§ç±»éå¸¸ä¸°å¯Œ';
    if (score >= 8) return 'è‰¯å¥½ï¼Œå¯ä»¥å¢åŠ ä¸€äº›é£Ÿç‰©ç§ç±»';
    if (score >= 5) return 'ä¸€èˆ¬ï¼Œå»ºè®®å¢åŠ æ›´å¤šç§ç±»çš„å¥åº·é£Ÿç‰©';
    return 'è¾ƒå·®ï¼Œæ‚¨çš„é¥®é£Ÿç§ç±»è¿‡äºå•ä¸€';
}

function generateDietAnalysis(breakfastItems, mealsPerDay, eatOut, snacks, water) {
    let analysis = '<ul>';

    // æ—©é¤åˆ†æ
    if (breakfastItems.length === 0) {
        analysis += '<li>âŒ æ‚¨ç»å¸¸ä¸åƒæ—©é¤ï¼Œè¿™æ˜¯ä¸å¥åº·çš„ä¹ æƒ¯</li>';
    } else {
        analysis += '<li>âœ… æ—©é¤åŒ…å«ï¼š' + breakfastItems.map(item => {
            const names = {
                'protein': 'è›‹ç™½è´¨',
                'wholeGrain': 'å…¨è°·ç‰©',
                'fruit': 'æ°´æœ',
                'vegetable': 'è”¬èœ'
            };
            return names[item];
        }).join('ã€') + '</li>';

        if (!breakfastItems.includes('protein')) {
            analysis += '<li>âŒ æ—©é¤ç¼ºä¹è›‹ç™½è´¨ï¼Œå»ºè®®å¢åŠ è›‹/å¥¶/è±†åˆ¶å“</li>';
        }
    }

    // è¿›é¤é¢‘ç‡
    if (mealsPerDay === 1) {
        analysis += '<li>âŒ æ‚¨æ¯å¤©åƒ1-2é¤ï¼Œå¯èƒ½å¯¼è‡´æš´é¥®æš´é£Ÿ</li>';
    } else if (mealsPerDay === 3) {
        analysis += '<li>âœ… è§„å¾‹çš„ä¸‰é¤ä¹ æƒ¯å¾ˆå¥½</li>';
    } else {
        analysis += '<li>ğŸ‘ ä¸‰é¤åŠ å¥åº·åŠ é¤æ˜¯ç†æƒ³æ¨¡å¼</li>';
    }

    // å¤–å–å’Œé›¶é£Ÿ
    if (eatOut >= 2) {
        analysis += `<li>âš ï¸ æ‚¨å¤–å‡ºå°±é¤è¾ƒé¢‘ç¹(æ¯å‘¨${eatOut}æ¬¡)ï¼Œæ³¨æ„æ§åˆ¶æ²¹ç›æ‘„å…¥</li>`;
    }

    if (snacks >= 2) {
        analysis += `<li>âš ï¸ é›¶é£Ÿæ‘„å…¥è¾ƒå¤š(æ¯å‘¨${snacks}æ¬¡)ï¼Œå»ºè®®é€‰æ‹©åšæœ/é…¸å¥¶æ›¿ä»£ç”œé£Ÿ</li>`;
    }

    // é¥®æ°´
    if (water <= 1) {
        analysis += '<li>âŒ é¥®æ°´ä¸è¶³ï¼Œå¯èƒ½å½±å“ä»£è°¢å’Œè®¤çŸ¥åŠŸèƒ½</li>';
    } else if (water >= 2) {
        analysis += '<li>âœ… è‰¯å¥½çš„é¥®æ°´ä¹ æƒ¯</li>';
    }

    analysis += '</ul>';
    return analysis;
}

function generateDietRecommendations(ddsScore, bmiCategory, breakfastItems, eatOut, snacks, water) {
    let rec = '<ul>';

    // æ ¹æ®BMIçš„å»ºè®®
    if (bmiCategory === 'åç˜¦') {
        rec += '<li>å¢åŠ å¥åº·çƒ­é‡æ‘„å…¥ï¼šåšæœã€é³„æ¢¨ã€æ©„æ¦„æ²¹ç­‰</li>';
    } else if (bmiCategory === 'è¶…é‡' || bmiCategory === 'è‚¥èƒ–') {
        rec += '<li>æ§åˆ¶ç²¾åˆ¶ç¢³æ°´ï¼šå‡å°‘ç™½ç±³ç™½é¢ï¼Œå¢åŠ å…¨è°·ç‰©å’Œè”¬èœ</li>';
    }

    // é¥®é£Ÿå¤šæ ·æ€§å»ºè®®
    if (ddsScore < 8) {
        rec += '<li>æ¯å‘¨å°è¯•2ç§æ–°è”¬èœå’Œ1ç§æ–°æ°´æœ</li>';
        rec += '<li>è›‹ç™½è´¨æ¥æºå¤šæ ·åŒ–ï¼šé±¼ã€è±†ã€è›‹ã€ç˜¦è‚‰è½®æ¢</li>';
    }

    // æ—©é¤å»ºè®®
    if (!breakfastItems.includes('protein')) {
        rec += '<li>æ—©é¤å¢åŠ ï¼šé¸¡è›‹ã€å¸Œè…Šé…¸å¥¶æˆ–è±†åˆ¶å“æä¾›è›‹ç™½è´¨</li>';
    }

    // å…¶ä»–å»ºè®®
    if (eatOut >= 2) {
        rec += '<li>å‡å°‘å¤–å–ï¼šæ¯å‘¨è‡ªå¤‡åˆé¤3-4å¤©</li>';
    }

    if (snacks >= 2) {
        rec += '<li>å¥åº·é›¶é£Ÿï¼šé€‰æ‹©åšæœã€æ°´æœä»£æ›¿ç”œç‚¹</li>';
    }

    if (water <= 1) {
        rec += '<li>å¢åŠ é¥®æ°´é‡ï¼šæ¯å¤©è‡³å°‘8æ¯æ°´ï¼ˆçº¦2000mlï¼‰</li>';
    }

    rec += '</ul>';
    return rec;
}

function generateMealPlan(bmiCategory, activity, gender, age) {
    let plan = '<p><strong>åŸºç¡€é¥®é£Ÿå»ºè®®ï¼š</strong></p><ul>';

    // æ ¹æ®BMIæä¾›å»ºè®®
    switch(bmiCategory) {
        case 'åç˜¦':
            plan += '<li>æ¯æ—¥5-6é¤ï¼Œå¢åŠ å¥åº·çƒ­é‡æ¥æº</li>';
            plan += '<li>é¤é—´åŠ é¤ï¼šåšæœã€å¥¶é…ªã€æ°´æœ</li>';
            break;
        case 'æ­£å¸¸':
            plan += '<li>å‡è¡¡ä¸‰é¤ï¼Œé€‚é‡åŠ é¤</li>';
            plan += '<li>ä¿æŒé£Ÿç‰©å¤šæ ·æ€§ï¼Œæ¯å¤©12ç§ä»¥ä¸Šé£Ÿæ</li>';
            break;
        default: // è¶…é‡æˆ–è‚¥èƒ–
            plan += '<li>æ§åˆ¶æ€»çƒ­é‡ï¼Œå¢åŠ è†³é£Ÿçº¤ç»´</li>';
            plan += '<li>é‡‡ç”¨211é¤ç›˜æ³•ï¼š2ä»½è”¬èœ+1ä»½è›‹ç™½è´¨+1ä»½ä¸»é£Ÿ</li>';
    }

    // æ ¹æ®æ´»åŠ¨æ°´å¹³
    if (activity === 'sedentary') {
        plan += '<li>æ§åˆ¶ç²¾åˆ¶ç¢³æ°´ï¼Œå¢åŠ ä¼˜è´¨è›‹ç™½æ¯”ä¾‹</li>';
    } else if (activity === 'moderate' || activity === 'active') {
        plan += '<li>è¿åŠ¨å‰åè¡¥å……é€‚é‡ç¢³æ°´+è›‹ç™½ï¼ˆå¦‚é¦™è•‰+é…¸å¥¶ï¼‰</li>';
    }

    // æ ¹æ®å¹´é¾„å’Œæ€§åˆ«
    if (age > 50) {
        plan += '<li>å¢åŠ é’™å’Œç»´ç”Ÿç´ Dæ‘„å…¥ï¼šå¥¶åˆ¶å“ã€é±¼ç±»</li>';
    }
    if (gender === 'female') {
        plan += '<li>ä¿è¯è¶³å¤Ÿçš„é“æ‘„å…¥ï¼šçº¢è‚‰ã€è èœã€è±†ç±»</li>';
    }

    plan += '</ul>';

    // æ·»åŠ ç¤ºä¾‹é¤å•
    plan += `
        <p><strong>ç¤ºä¾‹ä¸€æ—¥é¤å•ï¼š</strong></p>
        <ul>
            <li>æ—©é¤ï¼šå…¨éº¦é¢åŒ…2ç‰‡ + é¸¡è›‹1ä¸ª + ç‰›å¥¶200ml + è‹¹æœåŠä¸ª</li>
            <li>åˆé¤ï¼šç³™ç±³é¥­1ç¢— + æ¸…è’¸é±¼150g + ç‚’æ—¶è”¬200g</li>
            <li>åŠ é¤ï¼šå¸Œè…Šé…¸å¥¶100g + åšæœ15g</li>
            <li>æ™šé¤ï¼šæ‚ç²®é¥­3/4ç¢— + é¸¡èƒ¸è‚‰100g + è”¬èœæ²™æ‹‰200g</li>
        </ul>
    `;

    return plan;
}



    // ç”¨æˆ·IDç”Ÿæˆä¸åˆå§‹åŒ–
let userId = localStorage.getItem('healthUserId');
if (!userId) {
  userId = 'user_' + Date.now();
  localStorage.setItem('healthUserId', userId);
}

// æ•°æ®ç»“æ„
let healthData = JSON.parse(localStorage.getItem('healthData')) || {
  userId: userId,
  reports: []
};

// ä¿å­˜æŠ¥å‘Šå‡½æ•°
function saveReport(type, score, details) {
  healthData.reports.push({
    type,
    score,
    details,
    timestamp: new Date().toISOString()
  });
  localStorage.setItem('healthData', JSON.stringify(healthData));
}



    // åŠ è½½å†å²è®°å½•
function loadReports() {
  const reports = healthData.reports;
  const container = document.getElementById('reports-list');

  if (reports.length === 0) {
    container.innerHTML = '<p>æš‚æ— å†å²è®°å½•</p>';
    return;
  }

  let html = reports.map(report => `
    <div class="report-item">
      <h3>${getReportName(report.type)}</h3>
      <p>å¾—åˆ†: ${report.score.toFixed(1)}</p>
      <p>æ—¶é—´: ${new Date(report.timestamp).toLocaleString()}</p>
    </div>
  `).join('');

  container.innerHTML = html;
}

// ç»¼åˆè¯„çº§è®¡ç®—
function calculateOverallRating() {
  const scores = {
    'blood-sugar': 0.2,
    'bmi': 0.2,
    'sleep': 0.15,
    'exercise': 0.15,
    'diet': 0.15,
    'mental': 0.15
  };

  let total = 0;
  let count = 0;

  healthData.reports.forEach(report => {
    if (scores[report.type]) {
      total += report.score * scores[report.type];
      count += scores[report.type];
    }
  });

  const overallScore = count > 0 ? total / count : 0;
  const rating = getRatingLevel(overallScore);

  document.getElementById('overall-rating').innerHTML = `
    <div class="result">
      <h2>ç»¼åˆå¾—åˆ†: ${overallScore.toFixed(1)}</h2>
      <h3>è¯„çº§: ${rating}</h3>
    </div>
  `;
}

// è¾…åŠ©å‡½æ•°
function getReportName(type) {
  const names = {
    'blood-sugar': 'è¡€ç³–æ£€æµ‹',
    'bmi': 'BMIè®¡ç®—',
    'sleep': 'ç¡çœ è´¨é‡',
    'exercise': 'è¿åŠ¨æ°´å¹³',
    'diet': 'é¥®é£Ÿå¥åº·',
    'mental': 'å¿ƒç†å¥åº·'
  };
  return names[type] || type;
}

function getRatingLevel(score) {
  if (score >= 90) return 'ä¼˜ç§€';
  if (score >= 80) return 'è‰¯å¥½';
  if (score >= 70) return 'ä¸­ç­‰';
  if (score >= 60) return 'ä¸€èˆ¬';
  return 'éœ€è¦æ”¹å–„';
}

// æ•°æ®å¯¼å‡ºåŠŸèƒ½
function exportData() {
  const dataStr = JSON.stringify(healthData);
  const blob = new Blob([dataStr], {type: 'application/json'});
  const url = URL.createObjectURL(blob);

  const a = document.createElement('a');
  a.href = url;
  a.download = `health-report-${userId}.json`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}


// åŠ è½½å†å²è®°å½•
function loadReports() {
  const container = document.getElementById('reports-list');
  const reports = healthData.reports;

  if (!reports || reports.length === 0) {
    container.innerHTML = `
      <div class="empty-state">
        <i class="fas fa-file-alt"></i>
        <h3>æš‚æ— æµ‹è¯„è®°å½•</h3>
        <p>å®Œæˆæµ‹è¯„åï¼Œæ‚¨çš„è®°å½•å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</p>
      </div>
    `;
    return;
  }

  // æŒ‰æ—¶é—´å€’åºæ’åº
  const sortedReports = [...reports].sort((a, b) =>
    new Date(b.timestamp) - new Date(a.timestamp)
  );

  container.innerHTML = sortedReports.map(report => {
    const date = new Date(report.timestamp);
    const typeName = getReportName(report.type);

    return `
      <div class="report-item">
        <div class="report-header">
          <div class="report-title">${typeName}</div>
          <div class="report-score">${report.score.toFixed(0)}</div>
        </div>

        <div class="report-time">${date.toLocaleString()}</div>

        <div class="report-details">
          ${renderReportDetails(report)}
        </div>
      </div>
    `;
  }).join('');
}

// æ¸²æŸ“æŠ¥å‘Šè¯¦æƒ…
function renderReportDetails(report) {
  switch(report.type) {
    case 'blood-sugar':
      return `
        <div class="detail-item">
          <div class="detail-label">è¡€ç³–å€¼</div>
          <div class="detail-value">${report.details.value.toFixed(1)} mmol/L</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">æµ‹é‡æ—¶é—´</div>
          <div class="detail-value">${report.details.time === 'fasting' ? 'ç©ºè…¹' : 'é¤å'}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">çŠ¶æ€</div>
          <div class="detail-value">${report.details.isNormal ? 'æ­£å¸¸' : 'å¼‚å¸¸'}</div>
        </div>
      `;

    case 'bmi':
      return `
        <div class="detail-item">
          <div class="detail-label">èº«é«˜</div>
          <div class="detail-value">${report.details.height} cm</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">ä½“é‡</div>
          <div class="detail-value">${report.details.weight} kg</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">BMI</div>
          <div class="detail-value">${report.details.bmi.toFixed(1)}</div>
        </div>
      `;

    // å…¶ä»–ç±»å‹çš„æŠ¥å‘Šè¯¦æƒ…ç±»ä¼¼å¤„ç†...
    default:
      return '';
  }
}



</script>
</body>
</html>